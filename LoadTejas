{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 1,
   "metadata": {},
   "outputs": [],
   "source": [
    "# !conda install -c conda-forge psycopg2-binary --yes\n",
    "# !conda install pandas=1.3.4 --yes\n",
    "# !conda update pandas numpy --yes"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "metadata": {},
   "outputs": [],
   "source": [
    "# 'AioClientCreator' Error Solution\n",
    "# !conda install anaconda --yes\n",
    "# !conda update fsspec --yes\n",
    "# !conda install -c anaconda boto3 --yes"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "metadata": {},
   "outputs": [],
   "source": [
    "# !pip install -q sagemaker sqlalchemy psycopg2-binary fsspec\n",
    "# !pip install -q s3fs fsspec"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "metadata": {},
   "outputs": [],
   "source": [
    "import json\n",
    "import boto3\n",
    "import sagemaker\n",
    "from sagemaker import get_execution_role\n",
    "\n",
    "import pandas as pd\n",
    "import numpy as np\n",
    "\n",
    "from sqlalchemy import create_engine, text\n",
    "from sqlalchemy.orm import sessionmaker\n",
    "\n",
    "from sagemaker.feature_store.feature_group import FeatureGroup\n",
    "\n",
    "pd.set_option('display.max_columns', 500)\n",
    "pd.set_option('display.max_rows', 500)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "metadata": {},
   "outputs": [],
   "source": [
    "import requests"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "metadata": {},
   "outputs": [],
   "source": [
    "# Get region\n",
    "session = boto3.session.Session()\n",
    "region_name = session.region_name\n",
    "\n",
    "# Get SageMaker session & default S3 bucket\n",
    "sagemaker_session = sagemaker.Session()\n",
    "bucket = sagemaker_session.default_bucket() #replace with your own bucket name if you have one\n",
    "try:\n",
    "    role = sagemaker.get_execution_role()\n",
    "except:\n",
    "    role = get_execution_role('sagemaker')\n",
    "\n",
    "iam = boto3.client('iam')\n",
    "sts = boto3.client('sts')\n",
    "redshift = boto3.client('redshift')\n",
    "sm = boto3.client('sagemaker')\n",
    "s3 = sagemaker_session.boto_session.resource('s3')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "available\n"
     ]
    }
   ],
   "source": [
    "datawarehouse = 'ph'\n",
    "\n",
    "secretsmanager = boto3.client('secretsmanager')\n",
    "secret = secretsmanager.get_secret_value(SecretId=f'data_science_{datawarehouse}_redshift_login_tnanaware')\n",
    "cred = json.loads(secret['SecretString'])\n",
    "redshift_cluster_identifier = cred['dbClusterIdentifier']\n",
    "redshift_port = cred['port']\n",
    "database_name_redshift = datawarehouse\n",
    "master_user_name = cred['username']\n",
    "master_user_pw = cred['password']\n",
    "\n",
    "#check cluster status\n",
    "response = redshift.describe_clusters(ClusterIdentifier=redshift_cluster_identifier)\n",
    "cluster_status = response['Clusters'][0]['ClusterStatus']\n",
    "print(cluster_status)\n",
    "\n",
    "# Get Redshift Endpoint Address & IAM Role\n",
    "redshift_endpoint_address = response['Clusters'][0]['Endpoint']['Address']\n",
    "iam_role = response['Clusters'][0]['IamRoles'][0]['IamRoleArn']\n",
    "\n",
    "# Connect to Redshift Database Engine\n",
    "engine = create_engine('postgresql://{}:{}@{}:{}/{}'.format(master_user_name, master_user_pw, redshift_endpoint_address, redshift_port, database_name_redshift))\n",
    "\n",
    "# config session\n",
    "session = sessionmaker()\n",
    "session.configure(bind=engine)\n",
    "s = session()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "(15780, 44)\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>agency_name</th>\n",
       "      <th>agent_created_date</th>\n",
       "      <th>agent_type</th>\n",
       "      <th>birthdate</th>\n",
       "      <th>channel</th>\n",
       "      <th>agent_city</th>\n",
       "      <th>agent_email</th>\n",
       "      <th>enrollment_status</th>\n",
       "      <th>is_active</th>\n",
       "      <th>is_agency</th>\n",
       "      <th>is_test</th>\n",
       "      <th>mobile_phone</th>\n",
       "      <th>name</th>\n",
       "      <th>npn</th>\n",
       "      <th>phone</th>\n",
       "      <th>pivot_id</th>\n",
       "      <th>postal_code</th>\n",
       "      <th>agent_state</th>\n",
       "      <th>agency_id</th>\n",
       "      <th>agent</th>\n",
       "      <th>agent_id</th>\n",
       "      <th>carrier</th>\n",
       "      <th>city</th>\n",
       "      <th>date_created</th>\n",
       "      <th>duration_category</th>\n",
       "      <th>effective_date</th>\n",
       "      <th>email</th>\n",
       "      <th>estimated_observed_duration</th>\n",
       "      <th>expiration_date</th>\n",
       "      <th>monthly_premium</th>\n",
       "      <th>monthly_sales_goal</th>\n",
       "      <th>payment_type</th>\n",
       "      <th>percentage_sales</th>\n",
       "      <th>plan_name</th>\n",
       "      <th>plan_tier</th>\n",
       "      <th>policy_id</th>\n",
       "      <th>premium_eltv</th>\n",
       "      <th>product_classification</th>\n",
       "      <th>product_type</th>\n",
       "      <th>revenue_eltv</th>\n",
       "      <th>sales_channel</th>\n",
       "      <th>state</th>\n",
       "      <th>termination_date</th>\n",
       "      <th>zip</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>None</td>\n",
       "      <td>2021-05-04</td>\n",
       "      <td>Brokerage Agent</td>\n",
       "      <td>1971-06-28</td>\n",
       "      <td>Brokerage</td>\n",
       "      <td>Lake Mary</td>\n",
       "      <td>cimacare@yahoo.com</td>\n",
       "      <td>Completed</td>\n",
       "      <td>True</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>None</td>\n",
       "      <td>Kattia Santamaria</td>\n",
       "      <td>None</td>\n",
       "      <td>888-693-0431</td>\n",
       "      <td>61522</td>\n",
       "      <td>32746</td>\n",
       "      <td>FL</td>\n",
       "      <td>58649</td>\n",
       "      <td>Kattia Santamaria</td>\n",
       "      <td>61522</td>\n",
       "      <td>CLIC</td>\n",
       "      <td>Castroville</td>\n",
       "      <td>2021-01-01</td>\n",
       "      <td>364x1</td>\n",
       "      <td>2021-01-02</td>\n",
       "      <td>cimacare@yahoo.com</td>\n",
       "      <td>7.93</td>\n",
       "      <td>2021-12-31</td>\n",
       "      <td>47.59</td>\n",
       "      <td>100.0</td>\n",
       "      <td>CC</td>\n",
       "      <td>45.0</td>\n",
       "      <td>Companion Economy</td>\n",
       "      <td>Companion Economy</td>\n",
       "      <td>338812</td>\n",
       "      <td>114.160082</td>\n",
       "      <td>U65 Major Medical</td>\n",
       "      <td>STM</td>\n",
       "      <td>185.553237</td>\n",
       "      <td>Brokerage</td>\n",
       "      <td>TX</td>\n",
       "      <td>2021-12-31</td>\n",
       "      <td>78009</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>None</td>\n",
       "      <td>2021-05-04</td>\n",
       "      <td>Brokerage Agent</td>\n",
       "      <td>1992-07-03</td>\n",
       "      <td>Brokerage</td>\n",
       "      <td>Cooper City</td>\n",
       "      <td>odeameaghan123@outlook.com</td>\n",
       "      <td>Completed</td>\n",
       "      <td>True</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>None</td>\n",
       "      <td>Meagan O'Dea</td>\n",
       "      <td>18425849</td>\n",
       "      <td>954-600-7392</td>\n",
       "      <td>68781</td>\n",
       "      <td>33328</td>\n",
       "      <td>FL</td>\n",
       "      <td>62967</td>\n",
       "      <td>Meagan Jimenez</td>\n",
       "      <td>68781</td>\n",
       "      <td>CLIC</td>\n",
       "      <td>Melbourne</td>\n",
       "      <td>2021-01-05</td>\n",
       "      <td>364x1</td>\n",
       "      <td>2021-01-15</td>\n",
       "      <td>None</td>\n",
       "      <td>7.93</td>\n",
       "      <td>2022-01-13</td>\n",
       "      <td>174.70</td>\n",
       "      <td>NaN</td>\n",
       "      <td>ACH</td>\n",
       "      <td>45.0</td>\n",
       "      <td>Companion Quantum</td>\n",
       "      <td>Companion Quantum</td>\n",
       "      <td>339579</td>\n",
       "      <td>419.074727</td>\n",
       "      <td>U65 Major Medical</td>\n",
       "      <td>STM</td>\n",
       "      <td>523.025711</td>\n",
       "      <td>Brokerage</td>\n",
       "      <td>FL</td>\n",
       "      <td>2022-01-13</td>\n",
       "      <td>32935</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>None</td>\n",
       "      <td>2021-05-04</td>\n",
       "      <td>Brokerage Agent</td>\n",
       "      <td>1985-01-18</td>\n",
       "      <td>Brokerage</td>\n",
       "      <td>Franklinton</td>\n",
       "      <td>suikhamh@yahoo.com</td>\n",
       "      <td>Completed</td>\n",
       "      <td>True</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>None</td>\n",
       "      <td>Sui Cer Khamh</td>\n",
       "      <td>19017372</td>\n",
       "      <td>919-916-0937</td>\n",
       "      <td>70765</td>\n",
       "      <td>27525</td>\n",
       "      <td>NC</td>\n",
       "      <td>70765</td>\n",
       "      <td>Sui Cer Khamh</td>\n",
       "      <td>70765</td>\n",
       "      <td>NRIC</td>\n",
       "      <td>Indianapolis</td>\n",
       "      <td>2021-01-07</td>\n",
       "      <td>364x1</td>\n",
       "      <td>2021-01-08</td>\n",
       "      <td>None</td>\n",
       "      <td>7.93</td>\n",
       "      <td>2022-01-06</td>\n",
       "      <td>67.56</td>\n",
       "      <td>NaN</td>\n",
       "      <td>CC</td>\n",
       "      <td>45.0</td>\n",
       "      <td>EPIC BASE Plan</td>\n",
       "      <td>North River Base</td>\n",
       "      <td>340130</td>\n",
       "      <td>139.295208</td>\n",
       "      <td>U65 Major Medical</td>\n",
       "      <td>STM</td>\n",
       "      <td>211.838459</td>\n",
       "      <td>Brokerage</td>\n",
       "      <td>IN</td>\n",
       "      <td>2021-02-07</td>\n",
       "      <td>46227</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>None</td>\n",
       "      <td>2021-05-04</td>\n",
       "      <td>Brokerage Agent</td>\n",
       "      <td>1962-11-16</td>\n",
       "      <td>Brokerage</td>\n",
       "      <td>Lawrence</td>\n",
       "      <td>lat@milnergroup.com</td>\n",
       "      <td>Completed</td>\n",
       "      <td>True</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>None</td>\n",
       "      <td>Willis (Lat) Milner</td>\n",
       "      <td>1023744</td>\n",
       "      <td>678-252-1776</td>\n",
       "      <td>63783</td>\n",
       "      <td>30043</td>\n",
       "      <td>GA</td>\n",
       "      <td>60436</td>\n",
       "      <td>Willis (Lat) Milner</td>\n",
       "      <td>63783</td>\n",
       "      <td>NRIC</td>\n",
       "      <td>Atlanta</td>\n",
       "      <td>2021-01-13</td>\n",
       "      <td>180x2</td>\n",
       "      <td>2021-01-20</td>\n",
       "      <td>None</td>\n",
       "      <td>7.93</td>\n",
       "      <td>2022-01-14</td>\n",
       "      <td>228.48</td>\n",
       "      <td>NaN</td>\n",
       "      <td>CC</td>\n",
       "      <td>15.0</td>\n",
       "      <td>EPIC BASE Plan</td>\n",
       "      <td>North River Base</td>\n",
       "      <td>341476</td>\n",
       "      <td>543.553920</td>\n",
       "      <td>U65 Major Medical</td>\n",
       "      <td>STM</td>\n",
       "      <td>657.315059</td>\n",
       "      <td>Brokerage</td>\n",
       "      <td>GA</td>\n",
       "      <td>2021-07-18</td>\n",
       "      <td>30326</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>None</td>\n",
       "      <td>2021-05-04</td>\n",
       "      <td>Brokerage Agent</td>\n",
       "      <td>1987-12-14</td>\n",
       "      <td>Brokerage</td>\n",
       "      <td>Boca Raton</td>\n",
       "      <td>aahealthagency@outlook.com</td>\n",
       "      <td>Completed</td>\n",
       "      <td>True</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>None</td>\n",
       "      <td>Nicole Connolly</td>\n",
       "      <td>18245457</td>\n",
       "      <td>800-214-0714</td>\n",
       "      <td>60767</td>\n",
       "      <td>33431</td>\n",
       "      <td>FL</td>\n",
       "      <td>57387</td>\n",
       "      <td>Nicole Connolly</td>\n",
       "      <td>60767</td>\n",
       "      <td>CLIC</td>\n",
       "      <td>Plano</td>\n",
       "      <td>2021-01-15</td>\n",
       "      <td>180x1</td>\n",
       "      <td>2021-01-16</td>\n",
       "      <td>None</td>\n",
       "      <td>4.17</td>\n",
       "      <td>2021-07-14</td>\n",
       "      <td>692.43</td>\n",
       "      <td>500.0</td>\n",
       "      <td>ACH</td>\n",
       "      <td>40.0</td>\n",
       "      <td>Companion Core</td>\n",
       "      <td>Companion Core</td>\n",
       "      <td>341986</td>\n",
       "      <td>873.448513</td>\n",
       "      <td>U65 Major Medical</td>\n",
       "      <td>STM</td>\n",
       "      <td>1007.304102</td>\n",
       "      <td>Brokerage</td>\n",
       "      <td>TX</td>\n",
       "      <td>2021-07-14</td>\n",
       "      <td>75023</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "  agency_name agent_created_date       agent_type  birthdate    channel  \\\n",
       "0        None         2021-05-04  Brokerage Agent 1971-06-28  Brokerage   \n",
       "1        None         2021-05-04  Brokerage Agent 1992-07-03  Brokerage   \n",
       "2        None         2021-05-04  Brokerage Agent 1985-01-18  Brokerage   \n",
       "3        None         2021-05-04  Brokerage Agent 1962-11-16  Brokerage   \n",
       "4        None         2021-05-04  Brokerage Agent 1987-12-14  Brokerage   \n",
       "\n",
       "    agent_city                 agent_email enrollment_status  is_active  \\\n",
       "0    Lake Mary          cimacare@yahoo.com         Completed       True   \n",
       "1  Cooper City  odeameaghan123@outlook.com         Completed       True   \n",
       "2  Franklinton          suikhamh@yahoo.com         Completed       True   \n",
       "3     Lawrence         lat@milnergroup.com         Completed       True   \n",
       "4   Boca Raton  aahealthagency@outlook.com         Completed       True   \n",
       "\n",
       "   is_agency  is_test mobile_phone                 name       npn  \\\n",
       "0      False    False         None    Kattia Santamaria      None   \n",
       "1      False    False         None         Meagan O'Dea  18425849   \n",
       "2      False    False         None        Sui Cer Khamh  19017372   \n",
       "3      False    False         None  Willis (Lat) Milner   1023744   \n",
       "4      False    False         None      Nicole Connolly  18245457   \n",
       "\n",
       "          phone pivot_id postal_code agent_state agency_id  \\\n",
       "0  888-693-0431    61522       32746          FL     58649   \n",
       "1  954-600-7392    68781       33328          FL     62967   \n",
       "2  919-916-0937    70765       27525          NC     70765   \n",
       "3  678-252-1776    63783       30043          GA     60436   \n",
       "4  800-214-0714    60767       33431          FL     57387   \n",
       "\n",
       "                 agent agent_id carrier          city date_created  \\\n",
       "0    Kattia Santamaria    61522    CLIC   Castroville   2021-01-01   \n",
       "1       Meagan Jimenez    68781    CLIC     Melbourne   2021-01-05   \n",
       "2        Sui Cer Khamh    70765    NRIC  Indianapolis   2021-01-07   \n",
       "3  Willis (Lat) Milner    63783    NRIC       Atlanta   2021-01-13   \n",
       "4      Nicole Connolly    60767    CLIC         Plano   2021-01-15   \n",
       "\n",
       "  duration_category effective_date               email  \\\n",
       "0             364x1     2021-01-02  cimacare@yahoo.com   \n",
       "1             364x1     2021-01-15                None   \n",
       "2             364x1     2021-01-08                None   \n",
       "3             180x2     2021-01-20                None   \n",
       "4             180x1     2021-01-16                None   \n",
       "\n",
       "   estimated_observed_duration expiration_date  monthly_premium  \\\n",
       "0                         7.93      2021-12-31            47.59   \n",
       "1                         7.93      2022-01-13           174.70   \n",
       "2                         7.93      2022-01-06            67.56   \n",
       "3                         7.93      2022-01-14           228.48   \n",
       "4                         4.17      2021-07-14           692.43   \n",
       "\n",
       "   monthly_sales_goal payment_type  percentage_sales          plan_name  \\\n",
       "0               100.0           CC              45.0  Companion Economy   \n",
       "1                 NaN          ACH              45.0  Companion Quantum   \n",
       "2                 NaN           CC              45.0     EPIC BASE Plan   \n",
       "3                 NaN           CC              15.0     EPIC BASE Plan   \n",
       "4               500.0          ACH              40.0     Companion Core   \n",
       "\n",
       "           plan_tier policy_id  premium_eltv product_classification  \\\n",
       "0  Companion Economy    338812    114.160082      U65 Major Medical   \n",
       "1  Companion Quantum    339579    419.074727      U65 Major Medical   \n",
       "2   North River Base    340130    139.295208      U65 Major Medical   \n",
       "3   North River Base    341476    543.553920      U65 Major Medical   \n",
       "4     Companion Core    341986    873.448513      U65 Major Medical   \n",
       "\n",
       "  product_type  revenue_eltv sales_channel state termination_date    zip  \n",
       "0          STM    185.553237     Brokerage    TX       2021-12-31  78009  \n",
       "1          STM    523.025711     Brokerage    FL       2022-01-13  32935  \n",
       "2          STM    211.838459     Brokerage    IN       2021-02-07  46227  \n",
       "3          STM    657.315059     Brokerage    GA       2021-07-18  30326  \n",
       "4          STM   1007.304102     Brokerage    TX       2021-07-14  75023  "
      ]
     },
     "execution_count": 8,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# and sa.phone is not null and sa.birthdate is not null and sa.email is not null and sa.state is not null and sa.postal_code is not null;\n",
    "sql_statement = f'''\n",
    "select sa.agency_name, to_date(sa.agent_created_date, 'YYYY-MM-DD') as agent_created_date, sa.agent_type, sa.birthdate, sa.channel, sa.city as agent_city, sa.email as agent_email, sa.enrollment_status, sa.is_active,\n",
    "       sa.is_agency, sa.is_test, sa.mobile_phone, sa.name, sa.npn, sa.phone, sa.pivot_id, sa.postal_code, sa.state as agent_state,\n",
    "       rsv.agency_id, rsv.agent, rsv.agent_id, rsv.carrier, rsv.city, rsv.date_created, rsv.duration_category, rsv.effective_date, rsv.email, rsv.estimated_observed_duration,\n",
    "       rsv.expiration_date, rsv.monthly_premium, rsv.monthly_sales_goal, rsv.payment_type, rsv.percentage_sales, rsv.plan_name, rsv.plan_tier, rsv.policy_id, rsv.premium_eltv,\n",
    "       rsv.product_classification, rsv.product_type, rsv.revenue_eltv, rsv.sales_channel, rsv.state, rsv.termination_date, rsv.zip\n",
    "from reports.sales_view rsv\n",
    "left join salesforce.agent sa on rsv.agent_id=sa.pivot_id\n",
    "where rsv.sales_channel='Brokerage' and rsv.date_created >= '2021-01-01' and sa.phone is not null and sa.birthdate is not null and sa.email is not null and sa.postal_code is not null;\n",
    "'''\n",
    "sql_text = text(sql_statement)\n",
    "df_brokerage_agent_sales = pd.read_sql_query(sql_text, engine,\n",
    "                                             parse_dates=['termination_date', 'expiration_date', 'birthdate', 'effective_date', 'date_created', 'agent_created_date'])\n",
    "print(df_brokerage_agent_sales.shape)\n",
    "df_brokerage_agent_sales.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "agency_name                    83.555133\n",
       "email                          78.903676\n",
       "mobile_phone                   76.045627\n",
       "termination_date               50.494297\n",
       "monthly_sales_goal             42.420786\n",
       "percentage_sales               19.062104\n",
       "expiration_date                 9.531052\n",
       "npn                             2.141952\n",
       "product_classification          0.766793\n",
       "city                            0.209125\n",
       "payment_type                    0.209125\n",
       "zip                             0.209125\n",
       "carrier                         0.209125\n",
       "agent                           0.152091\n",
       "estimated_observed_duration     0.076046\n",
       "premium_eltv                    0.076046\n",
       "birthdate                       0.076046\n",
       "revenue_eltv                    0.076046\n",
       "agent_state                     0.012674\n",
       "enrollment_status               0.000000\n",
       "is_test                         0.000000\n",
       "is_agency                       0.000000\n",
       "is_active                       0.000000\n",
       "agent_email                     0.000000\n",
       "name                            0.000000\n",
       "agent_city                      0.000000\n",
       "channel                         0.000000\n",
       "agent_type                      0.000000\n",
       "agent_created_date              0.000000\n",
       "state                           0.000000\n",
       "plan_name                       0.000000\n",
       "sales_channel                   0.000000\n",
       "phone                           0.000000\n",
       "plan_tier                       0.000000\n",
       "postal_code                     0.000000\n",
       "agency_id                       0.000000\n",
       "agent_id                        0.000000\n",
       "product_type                    0.000000\n",
       "date_created                    0.000000\n",
       "duration_category               0.000000\n",
       "effective_date                  0.000000\n",
       "policy_id                       0.000000\n",
       "monthly_premium                 0.000000\n",
       "pivot_id                        0.000000\n",
       "dtype: float64"
      ]
     },
     "execution_count": 9,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df_brokerage_agent_sales.isnull().sum().sort_values(ascending=False) / df_brokerage_agent_sales.shape[0] * 100"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# Add Zipcode Info"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>zipcode</th>\n",
       "      <th>state</th>\n",
       "      <th>lat</th>\n",
       "      <th>lng</th>\n",
       "      <th>timezone</th>\n",
       "      <th>radius_in_miles</th>\n",
       "      <th>population</th>\n",
       "      <th>population_density</th>\n",
       "      <th>land_area_in_sqmi</th>\n",
       "      <th>water_area_in_sqmi</th>\n",
       "      <th>housing_units</th>\n",
       "      <th>occupied_housing_units</th>\n",
       "      <th>median_home_value</th>\n",
       "      <th>median_household_income</th>\n",
       "      <th>annual_checkup</th>\n",
       "      <th>arthritis</th>\n",
       "      <th>binge_drinking</th>\n",
       "      <th>copd</th>\n",
       "      <th>cancer_except_skin</th>\n",
       "      <th>cervical_cancer_screening</th>\n",
       "      <th>cholesterol_screening</th>\n",
       "      <th>chronic_kidney_disease</th>\n",
       "      <th>colorectal_cancer_screening</th>\n",
       "      <th>core_preventive_services_for_older_men</th>\n",
       "      <th>core_preventive_services_for_older_women</th>\n",
       "      <th>coronary_heart_disease</th>\n",
       "      <th>current_asthma</th>\n",
       "      <th>current_smoking</th>\n",
       "      <th>dental_visit</th>\n",
       "      <th>diabetes</th>\n",
       "      <th>health_insurance</th>\n",
       "      <th>high_blood_pressure</th>\n",
       "      <th>high_cholesterol</th>\n",
       "      <th>mammography</th>\n",
       "      <th>mental_health</th>\n",
       "      <th>obesity</th>\n",
       "      <th>physical_health</th>\n",
       "      <th>physical_inactivity</th>\n",
       "      <th>sleep_lt_7_hours</th>\n",
       "      <th>stroke</th>\n",
       "      <th>taking_bp_medication</th>\n",
       "      <th>teeth_loss</th>\n",
       "      <th>ma_penetration_2020</th>\n",
       "      <th>ma_penetration_2021</th>\n",
       "      <th>delta_ma_enrolled</th>\n",
       "      <th>delta_ma_penetration_points</th>\n",
       "      <th>event_time</th>\n",
       "      <th>write_time</th>\n",
       "      <th>api_invocation_time</th>\n",
       "      <th>is_deleted</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>35087</td>\n",
       "      <td>AL</td>\n",
       "      <td>34.2837</td>\n",
       "      <td>-86.5519</td>\n",
       "      <td>Central</td>\n",
       "      <td>5.0</td>\n",
       "      <td>2115.0</td>\n",
       "      <td>94.0</td>\n",
       "      <td>22.43</td>\n",
       "      <td>0.17</td>\n",
       "      <td>932.0</td>\n",
       "      <td>816.0</td>\n",
       "      <td>93600.0</td>\n",
       "      <td>39375.0</td>\n",
       "      <td>76.70</td>\n",
       "      <td>35.333333</td>\n",
       "      <td>12.933333</td>\n",
       "      <td>10.533333</td>\n",
       "      <td>7.90</td>\n",
       "      <td>83.966667</td>\n",
       "      <td>80.266667</td>\n",
       "      <td>3.466667</td>\n",
       "      <td>66.433333</td>\n",
       "      <td>35.00</td>\n",
       "      <td>33.633333</td>\n",
       "      <td>9.233333</td>\n",
       "      <td>10.333333</td>\n",
       "      <td>21.333333</td>\n",
       "      <td>58.80</td>\n",
       "      <td>13.966667</td>\n",
       "      <td>16.033333</td>\n",
       "      <td>40.60</td>\n",
       "      <td>40.166667</td>\n",
       "      <td>74.233333</td>\n",
       "      <td>16.533333</td>\n",
       "      <td>36.566667</td>\n",
       "      <td>16.233333</td>\n",
       "      <td>31.033333</td>\n",
       "      <td>36.066667</td>\n",
       "      <td>4.233333</td>\n",
       "      <td>78.80</td>\n",
       "      <td>18.966667</td>\n",
       "      <td>44.27</td>\n",
       "      <td>48.76</td>\n",
       "      <td>1016.0</td>\n",
       "      <td>4.49</td>\n",
       "      <td>1.636493e+09</td>\n",
       "      <td>2021-11-09 21:28:53.797</td>\n",
       "      <td>2021-11-09 21:23:56</td>\n",
       "      <td>False</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>49015</td>\n",
       "      <td>MI</td>\n",
       "      <td>42.3028</td>\n",
       "      <td>-85.2128</td>\n",
       "      <td>Eastern</td>\n",
       "      <td>5.0</td>\n",
       "      <td>26782.0</td>\n",
       "      <td>1139.0</td>\n",
       "      <td>23.52</td>\n",
       "      <td>0.64</td>\n",
       "      <td>12315.0</td>\n",
       "      <td>11170.0</td>\n",
       "      <td>110600.0</td>\n",
       "      <td>49877.0</td>\n",
       "      <td>79.00</td>\n",
       "      <td>32.300000</td>\n",
       "      <td>17.600000</td>\n",
       "      <td>9.600000</td>\n",
       "      <td>7.70</td>\n",
       "      <td>84.200000</td>\n",
       "      <td>81.500000</td>\n",
       "      <td>3.400000</td>\n",
       "      <td>68.400000</td>\n",
       "      <td>35.00</td>\n",
       "      <td>30.000000</td>\n",
       "      <td>8.400000</td>\n",
       "      <td>10.700000</td>\n",
       "      <td>21.000000</td>\n",
       "      <td>63.80</td>\n",
       "      <td>12.500000</td>\n",
       "      <td>10.900000</td>\n",
       "      <td>36.30</td>\n",
       "      <td>36.200000</td>\n",
       "      <td>73.900000</td>\n",
       "      <td>14.800000</td>\n",
       "      <td>37.500000</td>\n",
       "      <td>15.100000</td>\n",
       "      <td>27.400000</td>\n",
       "      <td>38.400000</td>\n",
       "      <td>3.900000</td>\n",
       "      <td>77.50</td>\n",
       "      <td>13.900000</td>\n",
       "      <td>37.16</td>\n",
       "      <td>42.07</td>\n",
       "      <td>1612.0</td>\n",
       "      <td>4.91</td>\n",
       "      <td>1.636493e+09</td>\n",
       "      <td>2021-11-09 21:28:53.797</td>\n",
       "      <td>2021-11-09 21:23:56</td>\n",
       "      <td>False</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>76271</td>\n",
       "      <td>TX</td>\n",
       "      <td>33.4675</td>\n",
       "      <td>-96.9097</td>\n",
       "      <td>Central</td>\n",
       "      <td>8.0</td>\n",
       "      <td>1352.0</td>\n",
       "      <td>34.0</td>\n",
       "      <td>39.53</td>\n",
       "      <td>13.01</td>\n",
       "      <td>659.0</td>\n",
       "      <td>560.0</td>\n",
       "      <td>109900.0</td>\n",
       "      <td>47981.0</td>\n",
       "      <td>74.55</td>\n",
       "      <td>28.300000</td>\n",
       "      <td>16.400000</td>\n",
       "      <td>8.400000</td>\n",
       "      <td>7.75</td>\n",
       "      <td>81.850000</td>\n",
       "      <td>81.000000</td>\n",
       "      <td>3.300000</td>\n",
       "      <td>61.800000</td>\n",
       "      <td>25.95</td>\n",
       "      <td>25.150000</td>\n",
       "      <td>8.400000</td>\n",
       "      <td>9.450000</td>\n",
       "      <td>18.100000</td>\n",
       "      <td>57.95</td>\n",
       "      <td>12.750000</td>\n",
       "      <td>21.650000</td>\n",
       "      <td>36.95</td>\n",
       "      <td>38.000000</td>\n",
       "      <td>69.500000</td>\n",
       "      <td>14.000000</td>\n",
       "      <td>36.050000</td>\n",
       "      <td>14.000000</td>\n",
       "      <td>27.100000</td>\n",
       "      <td>34.900000</td>\n",
       "      <td>3.800000</td>\n",
       "      <td>77.40</td>\n",
       "      <td>14.950000</td>\n",
       "      <td>35.13</td>\n",
       "      <td>39.08</td>\n",
       "      <td>1413.0</td>\n",
       "      <td>3.95</td>\n",
       "      <td>1.636493e+09</td>\n",
       "      <td>2021-11-09 21:28:53.797</td>\n",
       "      <td>2021-11-09 21:23:56</td>\n",
       "      <td>False</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>75564</td>\n",
       "      <td>TX</td>\n",
       "      <td>32.8718</td>\n",
       "      <td>-94.2729</td>\n",
       "      <td>America/Anchorage</td>\n",
       "      <td>NaN</td>\n",
       "      <td>17603.0</td>\n",
       "      <td>2536.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>270900.0</td>\n",
       "      <td>56136.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>19.600000</td>\n",
       "      <td>14.500000</td>\n",
       "      <td>5.700000</td>\n",
       "      <td>4.50</td>\n",
       "      <td>73.400000</td>\n",
       "      <td>72.300000</td>\n",
       "      <td>2.800000</td>\n",
       "      <td>47.200000</td>\n",
       "      <td>21.40</td>\n",
       "      <td>25.000000</td>\n",
       "      <td>6.300000</td>\n",
       "      <td>7.800000</td>\n",
       "      <td>21.800000</td>\n",
       "      <td>56.70</td>\n",
       "      <td>13.600000</td>\n",
       "      <td>20.300000</td>\n",
       "      <td>33.00</td>\n",
       "      <td>33.200000</td>\n",
       "      <td>63.600000</td>\n",
       "      <td>11.600000</td>\n",
       "      <td>28.400000</td>\n",
       "      <td>13.300000</td>\n",
       "      <td>26.800000</td>\n",
       "      <td>39.900000</td>\n",
       "      <td>3.300000</td>\n",
       "      <td>66.20</td>\n",
       "      <td>22.000000</td>\n",
       "      <td>1.33</td>\n",
       "      <td>1.72</td>\n",
       "      <td>178.0</td>\n",
       "      <td>0.39</td>\n",
       "      <td>1.636493e+09</td>\n",
       "      <td>2021-11-09 21:28:53.797</td>\n",
       "      <td>2021-11-09 21:23:56</td>\n",
       "      <td>False</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>49751</td>\n",
       "      <td>MI</td>\n",
       "      <td>45.0152</td>\n",
       "      <td>-84.3857</td>\n",
       "      <td>Eastern</td>\n",
       "      <td>17.0</td>\n",
       "      <td>2087.0</td>\n",
       "      <td>14.0</td>\n",
       "      <td>151.65</td>\n",
       "      <td>2.18</td>\n",
       "      <td>1997.0</td>\n",
       "      <td>886.0</td>\n",
       "      <td>97000.0</td>\n",
       "      <td>42031.0</td>\n",
       "      <td>80.55</td>\n",
       "      <td>39.450000</td>\n",
       "      <td>15.750000</td>\n",
       "      <td>11.750000</td>\n",
       "      <td>9.60</td>\n",
       "      <td>84.250000</td>\n",
       "      <td>83.550000</td>\n",
       "      <td>3.900000</td>\n",
       "      <td>70.550000</td>\n",
       "      <td>33.25</td>\n",
       "      <td>30.800000</td>\n",
       "      <td>10.950000</td>\n",
       "      <td>10.600000</td>\n",
       "      <td>21.300000</td>\n",
       "      <td>67.95</td>\n",
       "      <td>13.900000</td>\n",
       "      <td>9.700000</td>\n",
       "      <td>39.75</td>\n",
       "      <td>41.200000</td>\n",
       "      <td>72.550000</td>\n",
       "      <td>14.500000</td>\n",
       "      <td>36.100000</td>\n",
       "      <td>17.150000</td>\n",
       "      <td>27.850000</td>\n",
       "      <td>36.850000</td>\n",
       "      <td>4.650000</td>\n",
       "      <td>81.15</td>\n",
       "      <td>14.200000</td>\n",
       "      <td>38.00</td>\n",
       "      <td>42.29</td>\n",
       "      <td>332.0</td>\n",
       "      <td>4.29</td>\n",
       "      <td>1.636493e+09</td>\n",
       "      <td>2021-11-09 21:28:53.797</td>\n",
       "      <td>2021-11-09 21:23:57</td>\n",
       "      <td>False</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "   zipcode state      lat      lng           timezone  radius_in_miles  \\\n",
       "0    35087    AL  34.2837 -86.5519            Central              5.0   \n",
       "1    49015    MI  42.3028 -85.2128            Eastern              5.0   \n",
       "2    76271    TX  33.4675 -96.9097            Central              8.0   \n",
       "3    75564    TX  32.8718 -94.2729  America/Anchorage              NaN   \n",
       "4    49751    MI  45.0152 -84.3857            Eastern             17.0   \n",
       "\n",
       "   population  population_density  land_area_in_sqmi  water_area_in_sqmi  \\\n",
       "0      2115.0                94.0              22.43                0.17   \n",
       "1     26782.0              1139.0              23.52                0.64   \n",
       "2      1352.0                34.0              39.53               13.01   \n",
       "3     17603.0              2536.0                NaN                 NaN   \n",
       "4      2087.0                14.0             151.65                2.18   \n",
       "\n",
       "   housing_units  occupied_housing_units  median_home_value  \\\n",
       "0          932.0                   816.0            93600.0   \n",
       "1        12315.0                 11170.0           110600.0   \n",
       "2          659.0                   560.0           109900.0   \n",
       "3            NaN                     NaN           270900.0   \n",
       "4         1997.0                   886.0            97000.0   \n",
       "\n",
       "   median_household_income  annual_checkup  arthritis  binge_drinking  \\\n",
       "0                  39375.0           76.70  35.333333       12.933333   \n",
       "1                  49877.0           79.00  32.300000       17.600000   \n",
       "2                  47981.0           74.55  28.300000       16.400000   \n",
       "3                  56136.0             NaN  19.600000       14.500000   \n",
       "4                  42031.0           80.55  39.450000       15.750000   \n",
       "\n",
       "        copd  cancer_except_skin  cervical_cancer_screening  \\\n",
       "0  10.533333                7.90                  83.966667   \n",
       "1   9.600000                7.70                  84.200000   \n",
       "2   8.400000                7.75                  81.850000   \n",
       "3   5.700000                4.50                  73.400000   \n",
       "4  11.750000                9.60                  84.250000   \n",
       "\n",
       "   cholesterol_screening  chronic_kidney_disease  colorectal_cancer_screening  \\\n",
       "0              80.266667                3.466667                    66.433333   \n",
       "1              81.500000                3.400000                    68.400000   \n",
       "2              81.000000                3.300000                    61.800000   \n",
       "3              72.300000                2.800000                    47.200000   \n",
       "4              83.550000                3.900000                    70.550000   \n",
       "\n",
       "   core_preventive_services_for_older_men  \\\n",
       "0                                   35.00   \n",
       "1                                   35.00   \n",
       "2                                   25.95   \n",
       "3                                   21.40   \n",
       "4                                   33.25   \n",
       "\n",
       "   core_preventive_services_for_older_women  coronary_heart_disease  \\\n",
       "0                                 33.633333                9.233333   \n",
       "1                                 30.000000                8.400000   \n",
       "2                                 25.150000                8.400000   \n",
       "3                                 25.000000                6.300000   \n",
       "4                                 30.800000               10.950000   \n",
       "\n",
       "   current_asthma  current_smoking  dental_visit   diabetes  health_insurance  \\\n",
       "0       10.333333        21.333333         58.80  13.966667         16.033333   \n",
       "1       10.700000        21.000000         63.80  12.500000         10.900000   \n",
       "2        9.450000        18.100000         57.95  12.750000         21.650000   \n",
       "3        7.800000        21.800000         56.70  13.600000         20.300000   \n",
       "4       10.600000        21.300000         67.95  13.900000          9.700000   \n",
       "\n",
       "   high_blood_pressure  high_cholesterol  mammography  mental_health  \\\n",
       "0                40.60         40.166667    74.233333      16.533333   \n",
       "1                36.30         36.200000    73.900000      14.800000   \n",
       "2                36.95         38.000000    69.500000      14.000000   \n",
       "3                33.00         33.200000    63.600000      11.600000   \n",
       "4                39.75         41.200000    72.550000      14.500000   \n",
       "\n",
       "     obesity  physical_health  physical_inactivity  sleep_lt_7_hours  \\\n",
       "0  36.566667        16.233333            31.033333         36.066667   \n",
       "1  37.500000        15.100000            27.400000         38.400000   \n",
       "2  36.050000        14.000000            27.100000         34.900000   \n",
       "3  28.400000        13.300000            26.800000         39.900000   \n",
       "4  36.100000        17.150000            27.850000         36.850000   \n",
       "\n",
       "     stroke  taking_bp_medication  teeth_loss  ma_penetration_2020  \\\n",
       "0  4.233333                 78.80   18.966667                44.27   \n",
       "1  3.900000                 77.50   13.900000                37.16   \n",
       "2  3.800000                 77.40   14.950000                35.13   \n",
       "3  3.300000                 66.20   22.000000                 1.33   \n",
       "4  4.650000                 81.15   14.200000                38.00   \n",
       "\n",
       "   ma_penetration_2021  delta_ma_enrolled  delta_ma_penetration_points  \\\n",
       "0                48.76             1016.0                         4.49   \n",
       "1                42.07             1612.0                         4.91   \n",
       "2                39.08             1413.0                         3.95   \n",
       "3                 1.72              178.0                         0.39   \n",
       "4                42.29              332.0                         4.29   \n",
       "\n",
       "     event_time              write_time api_invocation_time  is_deleted  \n",
       "0  1.636493e+09 2021-11-09 21:28:53.797 2021-11-09 21:23:56       False  \n",
       "1  1.636493e+09 2021-11-09 21:28:53.797 2021-11-09 21:23:56       False  \n",
       "2  1.636493e+09 2021-11-09 21:28:53.797 2021-11-09 21:23:56       False  \n",
       "3  1.636493e+09 2021-11-09 21:28:53.797 2021-11-09 21:23:56       False  \n",
       "4  1.636493e+09 2021-11-09 21:28:53.797 2021-11-09 21:23:57       False  "
      ]
     },
     "execution_count": 10,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "zipcode_feature_group = FeatureGroup(\n",
    "    name='zipcode-feature-group-09-21-20-34', sagemaker_session=sagemaker_session\n",
    ")\n",
    "\n",
    "zipcode_feature_athena = zipcode_feature_group.athena_query()\n",
    "\n",
    "zipcode_sql = \"\"\"\n",
    "SELECT *\n",
    "FROM \"zipcode-feature-group-09-21-20-34-1636492943\"\n",
    "\"\"\"\n",
    "\n",
    "\n",
    "zipcode_feature_athena.run(zipcode_sql, output_location='s3://'+bucket+'zipcode-enriched/query-results/')\n",
    "\n",
    "zipcode_feature_athena.wait()\n",
    "df_zipcode_feature = zipcode_feature_athena.as_dataframe()\n",
    "df_zipcode_feature['write_time'] = pd.to_datetime(df_zipcode_feature['write_time'])\n",
    "df_zipcode_feature['api_invocation_time'] = pd.to_datetime(df_zipcode_feature['api_invocation_time'])\n",
    "df_zipcode_feature.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "(15778, 94)\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>agency_name</th>\n",
       "      <th>agent_created_date</th>\n",
       "      <th>agent_type</th>\n",
       "      <th>birthdate</th>\n",
       "      <th>channel</th>\n",
       "      <th>agent_city</th>\n",
       "      <th>agent_email</th>\n",
       "      <th>enrollment_status</th>\n",
       "      <th>is_active</th>\n",
       "      <th>is_agency</th>\n",
       "      <th>is_test</th>\n",
       "      <th>mobile_phone</th>\n",
       "      <th>name</th>\n",
       "      <th>npn</th>\n",
       "      <th>phone</th>\n",
       "      <th>pivot_id</th>\n",
       "      <th>postal_code</th>\n",
       "      <th>agent_state</th>\n",
       "      <th>agency_id</th>\n",
       "      <th>agent</th>\n",
       "      <th>agent_id</th>\n",
       "      <th>carrier</th>\n",
       "      <th>city</th>\n",
       "      <th>date_created</th>\n",
       "      <th>duration_category</th>\n",
       "      <th>effective_date</th>\n",
       "      <th>email</th>\n",
       "      <th>estimated_observed_duration</th>\n",
       "      <th>expiration_date</th>\n",
       "      <th>monthly_premium</th>\n",
       "      <th>monthly_sales_goal</th>\n",
       "      <th>payment_type</th>\n",
       "      <th>percentage_sales</th>\n",
       "      <th>plan_name</th>\n",
       "      <th>plan_tier</th>\n",
       "      <th>policy_id</th>\n",
       "      <th>premium_eltv</th>\n",
       "      <th>product_classification</th>\n",
       "      <th>product_type</th>\n",
       "      <th>revenue_eltv</th>\n",
       "      <th>sales_channel</th>\n",
       "      <th>state</th>\n",
       "      <th>termination_date</th>\n",
       "      <th>zip</th>\n",
       "      <th>zipcode</th>\n",
       "      <th>state_zip</th>\n",
       "      <th>lat</th>\n",
       "      <th>lng</th>\n",
       "      <th>timezone</th>\n",
       "      <th>radius_in_miles</th>\n",
       "      <th>population</th>\n",
       "      <th>population_density</th>\n",
       "      <th>land_area_in_sqmi</th>\n",
       "      <th>water_area_in_sqmi</th>\n",
       "      <th>housing_units</th>\n",
       "      <th>occupied_housing_units</th>\n",
       "      <th>median_home_value</th>\n",
       "      <th>median_household_income</th>\n",
       "      <th>annual_checkup</th>\n",
       "      <th>arthritis</th>\n",
       "      <th>binge_drinking</th>\n",
       "      <th>copd</th>\n",
       "      <th>cancer_except_skin</th>\n",
       "      <th>cervical_cancer_screening</th>\n",
       "      <th>cholesterol_screening</th>\n",
       "      <th>chronic_kidney_disease</th>\n",
       "      <th>colorectal_cancer_screening</th>\n",
       "      <th>core_preventive_services_for_older_men</th>\n",
       "      <th>core_preventive_services_for_older_women</th>\n",
       "      <th>coronary_heart_disease</th>\n",
       "      <th>current_asthma</th>\n",
       "      <th>current_smoking</th>\n",
       "      <th>dental_visit</th>\n",
       "      <th>diabetes</th>\n",
       "      <th>health_insurance</th>\n",
       "      <th>high_blood_pressure</th>\n",
       "      <th>high_cholesterol</th>\n",
       "      <th>mammography</th>\n",
       "      <th>mental_health</th>\n",
       "      <th>obesity</th>\n",
       "      <th>physical_health</th>\n",
       "      <th>physical_inactivity</th>\n",
       "      <th>sleep_lt_7_hours</th>\n",
       "      <th>stroke</th>\n",
       "      <th>taking_bp_medication</th>\n",
       "      <th>teeth_loss</th>\n",
       "      <th>ma_penetration_2020</th>\n",
       "      <th>ma_penetration_2021</th>\n",
       "      <th>delta_ma_enrolled</th>\n",
       "      <th>delta_ma_penetration_points</th>\n",
       "      <th>event_time</th>\n",
       "      <th>write_time</th>\n",
       "      <th>api_invocation_time</th>\n",
       "      <th>is_deleted</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>None</td>\n",
       "      <td>2021-05-04</td>\n",
       "      <td>Brokerage Agent</td>\n",
       "      <td>1971-06-28</td>\n",
       "      <td>Brokerage</td>\n",
       "      <td>Lake Mary</td>\n",
       "      <td>cimacare@yahoo.com</td>\n",
       "      <td>Completed</td>\n",
       "      <td>True</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>None</td>\n",
       "      <td>Kattia Santamaria</td>\n",
       "      <td>None</td>\n",
       "      <td>888-693-0431</td>\n",
       "      <td>61522</td>\n",
       "      <td>32746</td>\n",
       "      <td>FL</td>\n",
       "      <td>58649</td>\n",
       "      <td>Kattia Santamaria</td>\n",
       "      <td>61522</td>\n",
       "      <td>CLIC</td>\n",
       "      <td>Castroville</td>\n",
       "      <td>2021-01-01</td>\n",
       "      <td>364x1</td>\n",
       "      <td>2021-01-02</td>\n",
       "      <td>cimacare@yahoo.com</td>\n",
       "      <td>7.93</td>\n",
       "      <td>2021-12-31</td>\n",
       "      <td>47.59</td>\n",
       "      <td>100.0</td>\n",
       "      <td>CC</td>\n",
       "      <td>45.0</td>\n",
       "      <td>Companion Economy</td>\n",
       "      <td>Companion Economy</td>\n",
       "      <td>338812</td>\n",
       "      <td>114.160082</td>\n",
       "      <td>U65 Major Medical</td>\n",
       "      <td>STM</td>\n",
       "      <td>185.553237</td>\n",
       "      <td>Brokerage</td>\n",
       "      <td>TX</td>\n",
       "      <td>2021-12-31</td>\n",
       "      <td>78009</td>\n",
       "      <td>32746.0</td>\n",
       "      <td>FL</td>\n",
       "      <td>28.7577</td>\n",
       "      <td>-81.3508</td>\n",
       "      <td>Eastern</td>\n",
       "      <td>4.0</td>\n",
       "      <td>40571.0</td>\n",
       "      <td>1838.0</td>\n",
       "      <td>22.07</td>\n",
       "      <td>1.50</td>\n",
       "      <td>17700.0</td>\n",
       "      <td>15986.0</td>\n",
       "      <td>245100.0</td>\n",
       "      <td>75344.0</td>\n",
       "      <td>77.90</td>\n",
       "      <td>25.3</td>\n",
       "      <td>17.90</td>\n",
       "      <td>6.80</td>\n",
       "      <td>6.8</td>\n",
       "      <td>85.3</td>\n",
       "      <td>82.1</td>\n",
       "      <td>2.80</td>\n",
       "      <td>67.40</td>\n",
       "      <td>31.6</td>\n",
       "      <td>31.3</td>\n",
       "      <td>6.5</td>\n",
       "      <td>8.30</td>\n",
       "      <td>15.90</td>\n",
       "      <td>65.60</td>\n",
       "      <td>10.9</td>\n",
       "      <td>19.1</td>\n",
       "      <td>32.10</td>\n",
       "      <td>34.20</td>\n",
       "      <td>75.7</td>\n",
       "      <td>12.80</td>\n",
       "      <td>27.8</td>\n",
       "      <td>11.80</td>\n",
       "      <td>24.40</td>\n",
       "      <td>37.9</td>\n",
       "      <td>3.10</td>\n",
       "      <td>73.00</td>\n",
       "      <td>11.70</td>\n",
       "      <td>47.51</td>\n",
       "      <td>49.70</td>\n",
       "      <td>2804.0</td>\n",
       "      <td>2.19</td>\n",
       "      <td>1.636493e+09</td>\n",
       "      <td>2021-11-09 21:28:53.888</td>\n",
       "      <td>2021-11-09 21:24:11</td>\n",
       "      <td>False</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>None</td>\n",
       "      <td>2021-05-04</td>\n",
       "      <td>Brokerage Agent</td>\n",
       "      <td>1992-07-03</td>\n",
       "      <td>Brokerage</td>\n",
       "      <td>Cooper City</td>\n",
       "      <td>odeameaghan123@outlook.com</td>\n",
       "      <td>Completed</td>\n",
       "      <td>True</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>None</td>\n",
       "      <td>Meagan O'Dea</td>\n",
       "      <td>18425849</td>\n",
       "      <td>954-600-7392</td>\n",
       "      <td>68781</td>\n",
       "      <td>33328</td>\n",
       "      <td>FL</td>\n",
       "      <td>62967</td>\n",
       "      <td>Meagan Jimenez</td>\n",
       "      <td>68781</td>\n",
       "      <td>CLIC</td>\n",
       "      <td>Melbourne</td>\n",
       "      <td>2021-01-05</td>\n",
       "      <td>364x1</td>\n",
       "      <td>2021-01-15</td>\n",
       "      <td>None</td>\n",
       "      <td>7.93</td>\n",
       "      <td>2022-01-13</td>\n",
       "      <td>174.70</td>\n",
       "      <td>NaN</td>\n",
       "      <td>ACH</td>\n",
       "      <td>45.0</td>\n",
       "      <td>Companion Quantum</td>\n",
       "      <td>Companion Quantum</td>\n",
       "      <td>339579</td>\n",
       "      <td>419.074727</td>\n",
       "      <td>U65 Major Medical</td>\n",
       "      <td>STM</td>\n",
       "      <td>523.025711</td>\n",
       "      <td>Brokerage</td>\n",
       "      <td>FL</td>\n",
       "      <td>2022-01-13</td>\n",
       "      <td>32935</td>\n",
       "      <td>33328.0</td>\n",
       "      <td>FL</td>\n",
       "      <td>26.0671</td>\n",
       "      <td>-80.2723</td>\n",
       "      <td>Eastern</td>\n",
       "      <td>2.0</td>\n",
       "      <td>27415.0</td>\n",
       "      <td>2916.0</td>\n",
       "      <td>9.40</td>\n",
       "      <td>0.08</td>\n",
       "      <td>10431.0</td>\n",
       "      <td>9956.0</td>\n",
       "      <td>284200.0</td>\n",
       "      <td>78566.0</td>\n",
       "      <td>79.70</td>\n",
       "      <td>23.8</td>\n",
       "      <td>15.80</td>\n",
       "      <td>7.40</td>\n",
       "      <td>6.9</td>\n",
       "      <td>84.4</td>\n",
       "      <td>83.3</td>\n",
       "      <td>3.30</td>\n",
       "      <td>64.60</td>\n",
       "      <td>26.7</td>\n",
       "      <td>27.4</td>\n",
       "      <td>7.3</td>\n",
       "      <td>8.70</td>\n",
       "      <td>16.50</td>\n",
       "      <td>64.40</td>\n",
       "      <td>13.1</td>\n",
       "      <td>23.9</td>\n",
       "      <td>35.20</td>\n",
       "      <td>34.30</td>\n",
       "      <td>74.3</td>\n",
       "      <td>13.10</td>\n",
       "      <td>29.8</td>\n",
       "      <td>13.60</td>\n",
       "      <td>26.00</td>\n",
       "      <td>40.6</td>\n",
       "      <td>3.80</td>\n",
       "      <td>75.00</td>\n",
       "      <td>14.40</td>\n",
       "      <td>59.36</td>\n",
       "      <td>61.51</td>\n",
       "      <td>11563.0</td>\n",
       "      <td>2.15</td>\n",
       "      <td>1.636493e+09</td>\n",
       "      <td>2021-11-09 21:28:53.842</td>\n",
       "      <td>2021-11-09 21:26:16</td>\n",
       "      <td>False</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>None</td>\n",
       "      <td>2021-05-04</td>\n",
       "      <td>Brokerage Agent</td>\n",
       "      <td>1985-01-18</td>\n",
       "      <td>Brokerage</td>\n",
       "      <td>Franklinton</td>\n",
       "      <td>suikhamh@yahoo.com</td>\n",
       "      <td>Completed</td>\n",
       "      <td>True</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>None</td>\n",
       "      <td>Sui Cer Khamh</td>\n",
       "      <td>19017372</td>\n",
       "      <td>919-916-0937</td>\n",
       "      <td>70765</td>\n",
       "      <td>27525</td>\n",
       "      <td>NC</td>\n",
       "      <td>70765</td>\n",
       "      <td>Sui Cer Khamh</td>\n",
       "      <td>70765</td>\n",
       "      <td>NRIC</td>\n",
       "      <td>Indianapolis</td>\n",
       "      <td>2021-01-07</td>\n",
       "      <td>364x1</td>\n",
       "      <td>2021-01-08</td>\n",
       "      <td>None</td>\n",
       "      <td>7.93</td>\n",
       "      <td>2022-01-06</td>\n",
       "      <td>67.56</td>\n",
       "      <td>NaN</td>\n",
       "      <td>CC</td>\n",
       "      <td>45.0</td>\n",
       "      <td>EPIC BASE Plan</td>\n",
       "      <td>North River Base</td>\n",
       "      <td>340130</td>\n",
       "      <td>139.295208</td>\n",
       "      <td>U65 Major Medical</td>\n",
       "      <td>STM</td>\n",
       "      <td>211.838459</td>\n",
       "      <td>Brokerage</td>\n",
       "      <td>IN</td>\n",
       "      <td>2021-02-07</td>\n",
       "      <td>46227</td>\n",
       "      <td>27525.0</td>\n",
       "      <td>NC</td>\n",
       "      <td>36.0955</td>\n",
       "      <td>-78.4486</td>\n",
       "      <td>Eastern</td>\n",
       "      <td>9.0</td>\n",
       "      <td>13338.0</td>\n",
       "      <td>144.0</td>\n",
       "      <td>92.51</td>\n",
       "      <td>0.29</td>\n",
       "      <td>5797.0</td>\n",
       "      <td>5172.0</td>\n",
       "      <td>129100.0</td>\n",
       "      <td>43090.0</td>\n",
       "      <td>80.15</td>\n",
       "      <td>29.7</td>\n",
       "      <td>14.55</td>\n",
       "      <td>8.75</td>\n",
       "      <td>7.4</td>\n",
       "      <td>85.4</td>\n",
       "      <td>80.7</td>\n",
       "      <td>3.45</td>\n",
       "      <td>66.75</td>\n",
       "      <td>35.3</td>\n",
       "      <td>36.0</td>\n",
       "      <td>8.1</td>\n",
       "      <td>10.05</td>\n",
       "      <td>20.55</td>\n",
       "      <td>62.35</td>\n",
       "      <td>13.8</td>\n",
       "      <td>19.0</td>\n",
       "      <td>39.75</td>\n",
       "      <td>37.05</td>\n",
       "      <td>76.3</td>\n",
       "      <td>14.15</td>\n",
       "      <td>35.2</td>\n",
       "      <td>14.25</td>\n",
       "      <td>27.25</td>\n",
       "      <td>37.2</td>\n",
       "      <td>4.25</td>\n",
       "      <td>78.65</td>\n",
       "      <td>18.25</td>\n",
       "      <td>42.63</td>\n",
       "      <td>47.52</td>\n",
       "      <td>864.0</td>\n",
       "      <td>4.89</td>\n",
       "      <td>1.636493e+09</td>\n",
       "      <td>2021-11-09 21:28:54.121</td>\n",
       "      <td>2021-11-09 21:26:11</td>\n",
       "      <td>False</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>None</td>\n",
       "      <td>2021-05-04</td>\n",
       "      <td>Brokerage Agent</td>\n",
       "      <td>1962-11-16</td>\n",
       "      <td>Brokerage</td>\n",
       "      <td>Lawrence</td>\n",
       "      <td>lat@milnergroup.com</td>\n",
       "      <td>Completed</td>\n",
       "      <td>True</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>None</td>\n",
       "      <td>Willis (Lat) Milner</td>\n",
       "      <td>1023744</td>\n",
       "      <td>678-252-1776</td>\n",
       "      <td>63783</td>\n",
       "      <td>30043</td>\n",
       "      <td>GA</td>\n",
       "      <td>60436</td>\n",
       "      <td>Willis (Lat) Milner</td>\n",
       "      <td>63783</td>\n",
       "      <td>NRIC</td>\n",
       "      <td>Atlanta</td>\n",
       "      <td>2021-01-13</td>\n",
       "      <td>180x2</td>\n",
       "      <td>2021-01-20</td>\n",
       "      <td>None</td>\n",
       "      <td>7.93</td>\n",
       "      <td>2022-01-14</td>\n",
       "      <td>228.48</td>\n",
       "      <td>NaN</td>\n",
       "      <td>CC</td>\n",
       "      <td>15.0</td>\n",
       "      <td>EPIC BASE Plan</td>\n",
       "      <td>North River Base</td>\n",
       "      <td>341476</td>\n",
       "      <td>543.553920</td>\n",
       "      <td>U65 Major Medical</td>\n",
       "      <td>STM</td>\n",
       "      <td>657.315059</td>\n",
       "      <td>Brokerage</td>\n",
       "      <td>GA</td>\n",
       "      <td>2021-07-18</td>\n",
       "      <td>30326</td>\n",
       "      <td>30043.0</td>\n",
       "      <td>GA</td>\n",
       "      <td>34.0031</td>\n",
       "      <td>-84.0126</td>\n",
       "      <td>Eastern</td>\n",
       "      <td>6.0</td>\n",
       "      <td>80241.0</td>\n",
       "      <td>2467.0</td>\n",
       "      <td>32.53</td>\n",
       "      <td>0.39</td>\n",
       "      <td>27767.0</td>\n",
       "      <td>25997.0</td>\n",
       "      <td>171000.0</td>\n",
       "      <td>67260.0</td>\n",
       "      <td>76.70</td>\n",
       "      <td>21.1</td>\n",
       "      <td>15.50</td>\n",
       "      <td>5.80</td>\n",
       "      <td>5.5</td>\n",
       "      <td>83.4</td>\n",
       "      <td>82.8</td>\n",
       "      <td>2.70</td>\n",
       "      <td>62.70</td>\n",
       "      <td>30.9</td>\n",
       "      <td>35.6</td>\n",
       "      <td>5.6</td>\n",
       "      <td>8.60</td>\n",
       "      <td>14.10</td>\n",
       "      <td>61.30</td>\n",
       "      <td>11.2</td>\n",
       "      <td>23.6</td>\n",
       "      <td>30.00</td>\n",
       "      <td>30.80</td>\n",
       "      <td>78.3</td>\n",
       "      <td>11.90</td>\n",
       "      <td>32.3</td>\n",
       "      <td>11.40</td>\n",
       "      <td>26.90</td>\n",
       "      <td>39.4</td>\n",
       "      <td>2.90</td>\n",
       "      <td>75.80</td>\n",
       "      <td>12.60</td>\n",
       "      <td>47.57</td>\n",
       "      <td>51.14</td>\n",
       "      <td>5919.0</td>\n",
       "      <td>3.57</td>\n",
       "      <td>1.636493e+09</td>\n",
       "      <td>2021-11-09 21:28:54.929</td>\n",
       "      <td>2021-11-09 21:25:48</td>\n",
       "      <td>False</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>None</td>\n",
       "      <td>2021-05-04</td>\n",
       "      <td>Brokerage Agent</td>\n",
       "      <td>1987-12-14</td>\n",
       "      <td>Brokerage</td>\n",
       "      <td>Boca Raton</td>\n",
       "      <td>aahealthagency@outlook.com</td>\n",
       "      <td>Completed</td>\n",
       "      <td>True</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>None</td>\n",
       "      <td>Nicole Connolly</td>\n",
       "      <td>18245457</td>\n",
       "      <td>800-214-0714</td>\n",
       "      <td>60767</td>\n",
       "      <td>33431</td>\n",
       "      <td>FL</td>\n",
       "      <td>57387</td>\n",
       "      <td>Nicole Connolly</td>\n",
       "      <td>60767</td>\n",
       "      <td>CLIC</td>\n",
       "      <td>Plano</td>\n",
       "      <td>2021-01-15</td>\n",
       "      <td>180x1</td>\n",
       "      <td>2021-01-16</td>\n",
       "      <td>None</td>\n",
       "      <td>4.17</td>\n",
       "      <td>2021-07-14</td>\n",
       "      <td>692.43</td>\n",
       "      <td>500.0</td>\n",
       "      <td>ACH</td>\n",
       "      <td>40.0</td>\n",
       "      <td>Companion Core</td>\n",
       "      <td>Companion Core</td>\n",
       "      <td>341986</td>\n",
       "      <td>873.448513</td>\n",
       "      <td>U65 Major Medical</td>\n",
       "      <td>STM</td>\n",
       "      <td>1007.304102</td>\n",
       "      <td>Brokerage</td>\n",
       "      <td>TX</td>\n",
       "      <td>2021-07-14</td>\n",
       "      <td>75023</td>\n",
       "      <td>33431.0</td>\n",
       "      <td>FL</td>\n",
       "      <td>26.3799</td>\n",
       "      <td>-80.0975</td>\n",
       "      <td>Eastern</td>\n",
       "      <td>3.0</td>\n",
       "      <td>18290.0</td>\n",
       "      <td>2057.0</td>\n",
       "      <td>8.89</td>\n",
       "      <td>0.77</td>\n",
       "      <td>8375.0</td>\n",
       "      <td>6896.0</td>\n",
       "      <td>295600.0</td>\n",
       "      <td>67500.0</td>\n",
       "      <td>80.40</td>\n",
       "      <td>28.0</td>\n",
       "      <td>16.30</td>\n",
       "      <td>8.50</td>\n",
       "      <td>8.7</td>\n",
       "      <td>85.7</td>\n",
       "      <td>84.2</td>\n",
       "      <td>3.60</td>\n",
       "      <td>66.60</td>\n",
       "      <td>32.8</td>\n",
       "      <td>30.6</td>\n",
       "      <td>8.6</td>\n",
       "      <td>8.30</td>\n",
       "      <td>15.20</td>\n",
       "      <td>65.70</td>\n",
       "      <td>13.6</td>\n",
       "      <td>21.9</td>\n",
       "      <td>36.00</td>\n",
       "      <td>36.40</td>\n",
       "      <td>75.6</td>\n",
       "      <td>12.60</td>\n",
       "      <td>29.3</td>\n",
       "      <td>14.00</td>\n",
       "      <td>28.50</td>\n",
       "      <td>35.6</td>\n",
       "      <td>4.10</td>\n",
       "      <td>77.20</td>\n",
       "      <td>13.80</td>\n",
       "      <td>42.39</td>\n",
       "      <td>44.41</td>\n",
       "      <td>9991.0</td>\n",
       "      <td>2.02</td>\n",
       "      <td>1.636493e+09</td>\n",
       "      <td>2021-11-09 21:28:53.878</td>\n",
       "      <td>2021-11-09 21:26:31</td>\n",
       "      <td>False</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "  agency_name agent_created_date       agent_type  birthdate    channel  \\\n",
       "0        None         2021-05-04  Brokerage Agent 1971-06-28  Brokerage   \n",
       "1        None         2021-05-04  Brokerage Agent 1992-07-03  Brokerage   \n",
       "2        None         2021-05-04  Brokerage Agent 1985-01-18  Brokerage   \n",
       "3        None         2021-05-04  Brokerage Agent 1962-11-16  Brokerage   \n",
       "4        None         2021-05-04  Brokerage Agent 1987-12-14  Brokerage   \n",
       "\n",
       "    agent_city                 agent_email enrollment_status  is_active  \\\n",
       "0    Lake Mary          cimacare@yahoo.com         Completed       True   \n",
       "1  Cooper City  odeameaghan123@outlook.com         Completed       True   \n",
       "2  Franklinton          suikhamh@yahoo.com         Completed       True   \n",
       "3     Lawrence         lat@milnergroup.com         Completed       True   \n",
       "4   Boca Raton  aahealthagency@outlook.com         Completed       True   \n",
       "\n",
       "   is_agency  is_test mobile_phone                 name       npn  \\\n",
       "0      False    False         None    Kattia Santamaria      None   \n",
       "1      False    False         None         Meagan O'Dea  18425849   \n",
       "2      False    False         None        Sui Cer Khamh  19017372   \n",
       "3      False    False         None  Willis (Lat) Milner   1023744   \n",
       "4      False    False         None      Nicole Connolly  18245457   \n",
       "\n",
       "          phone pivot_id  postal_code agent_state agency_id  \\\n",
       "0  888-693-0431    61522        32746          FL     58649   \n",
       "1  954-600-7392    68781        33328          FL     62967   \n",
       "2  919-916-0937    70765        27525          NC     70765   \n",
       "3  678-252-1776    63783        30043          GA     60436   \n",
       "4  800-214-0714    60767        33431          FL     57387   \n",
       "\n",
       "                 agent agent_id carrier          city date_created  \\\n",
       "0    Kattia Santamaria    61522    CLIC   Castroville   2021-01-01   \n",
       "1       Meagan Jimenez    68781    CLIC     Melbourne   2021-01-05   \n",
       "2        Sui Cer Khamh    70765    NRIC  Indianapolis   2021-01-07   \n",
       "3  Willis (Lat) Milner    63783    NRIC       Atlanta   2021-01-13   \n",
       "4      Nicole Connolly    60767    CLIC         Plano   2021-01-15   \n",
       "\n",
       "  duration_category effective_date               email  \\\n",
       "0             364x1     2021-01-02  cimacare@yahoo.com   \n",
       "1             364x1     2021-01-15                None   \n",
       "2             364x1     2021-01-08                None   \n",
       "3             180x2     2021-01-20                None   \n",
       "4             180x1     2021-01-16                None   \n",
       "\n",
       "   estimated_observed_duration expiration_date  monthly_premium  \\\n",
       "0                         7.93      2021-12-31            47.59   \n",
       "1                         7.93      2022-01-13           174.70   \n",
       "2                         7.93      2022-01-06            67.56   \n",
       "3                         7.93      2022-01-14           228.48   \n",
       "4                         4.17      2021-07-14           692.43   \n",
       "\n",
       "   monthly_sales_goal payment_type  percentage_sales          plan_name  \\\n",
       "0               100.0           CC              45.0  Companion Economy   \n",
       "1                 NaN          ACH              45.0  Companion Quantum   \n",
       "2                 NaN           CC              45.0     EPIC BASE Plan   \n",
       "3                 NaN           CC              15.0     EPIC BASE Plan   \n",
       "4               500.0          ACH              40.0     Companion Core   \n",
       "\n",
       "           plan_tier policy_id  premium_eltv product_classification  \\\n",
       "0  Companion Economy    338812    114.160082      U65 Major Medical   \n",
       "1  Companion Quantum    339579    419.074727      U65 Major Medical   \n",
       "2   North River Base    340130    139.295208      U65 Major Medical   \n",
       "3   North River Base    341476    543.553920      U65 Major Medical   \n",
       "4     Companion Core    341986    873.448513      U65 Major Medical   \n",
       "\n",
       "  product_type  revenue_eltv sales_channel state termination_date    zip  \\\n",
       "0          STM    185.553237     Brokerage    TX       2021-12-31  78009   \n",
       "1          STM    523.025711     Brokerage    FL       2022-01-13  32935   \n",
       "2          STM    211.838459     Brokerage    IN       2021-02-07  46227   \n",
       "3          STM    657.315059     Brokerage    GA       2021-07-18  30326   \n",
       "4          STM   1007.304102     Brokerage    TX       2021-07-14  75023   \n",
       "\n",
       "   zipcode state_zip      lat      lng timezone  radius_in_miles  population  \\\n",
       "0  32746.0        FL  28.7577 -81.3508  Eastern              4.0     40571.0   \n",
       "1  33328.0        FL  26.0671 -80.2723  Eastern              2.0     27415.0   \n",
       "2  27525.0        NC  36.0955 -78.4486  Eastern              9.0     13338.0   \n",
       "3  30043.0        GA  34.0031 -84.0126  Eastern              6.0     80241.0   \n",
       "4  33431.0        FL  26.3799 -80.0975  Eastern              3.0     18290.0   \n",
       "\n",
       "   population_density  land_area_in_sqmi  water_area_in_sqmi  housing_units  \\\n",
       "0              1838.0              22.07                1.50        17700.0   \n",
       "1              2916.0               9.40                0.08        10431.0   \n",
       "2               144.0              92.51                0.29         5797.0   \n",
       "3              2467.0              32.53                0.39        27767.0   \n",
       "4              2057.0               8.89                0.77         8375.0   \n",
       "\n",
       "   occupied_housing_units  median_home_value  median_household_income  \\\n",
       "0                 15986.0           245100.0                  75344.0   \n",
       "1                  9956.0           284200.0                  78566.0   \n",
       "2                  5172.0           129100.0                  43090.0   \n",
       "3                 25997.0           171000.0                  67260.0   \n",
       "4                  6896.0           295600.0                  67500.0   \n",
       "\n",
       "   annual_checkup  arthritis  binge_drinking  copd  cancer_except_skin  \\\n",
       "0           77.90       25.3           17.90  6.80                 6.8   \n",
       "1           79.70       23.8           15.80  7.40                 6.9   \n",
       "2           80.15       29.7           14.55  8.75                 7.4   \n",
       "3           76.70       21.1           15.50  5.80                 5.5   \n",
       "4           80.40       28.0           16.30  8.50                 8.7   \n",
       "\n",
       "   cervical_cancer_screening  cholesterol_screening  chronic_kidney_disease  \\\n",
       "0                       85.3                   82.1                    2.80   \n",
       "1                       84.4                   83.3                    3.30   \n",
       "2                       85.4                   80.7                    3.45   \n",
       "3                       83.4                   82.8                    2.70   \n",
       "4                       85.7                   84.2                    3.60   \n",
       "\n",
       "   colorectal_cancer_screening  core_preventive_services_for_older_men  \\\n",
       "0                        67.40                                    31.6   \n",
       "1                        64.60                                    26.7   \n",
       "2                        66.75                                    35.3   \n",
       "3                        62.70                                    30.9   \n",
       "4                        66.60                                    32.8   \n",
       "\n",
       "   core_preventive_services_for_older_women  coronary_heart_disease  \\\n",
       "0                                      31.3                     6.5   \n",
       "1                                      27.4                     7.3   \n",
       "2                                      36.0                     8.1   \n",
       "3                                      35.6                     5.6   \n",
       "4                                      30.6                     8.6   \n",
       "\n",
       "   current_asthma  current_smoking  dental_visit  diabetes  health_insurance  \\\n",
       "0            8.30            15.90         65.60      10.9              19.1   \n",
       "1            8.70            16.50         64.40      13.1              23.9   \n",
       "2           10.05            20.55         62.35      13.8              19.0   \n",
       "3            8.60            14.10         61.30      11.2              23.6   \n",
       "4            8.30            15.20         65.70      13.6              21.9   \n",
       "\n",
       "   high_blood_pressure  high_cholesterol  mammography  mental_health  obesity  \\\n",
       "0                32.10             34.20         75.7          12.80     27.8   \n",
       "1                35.20             34.30         74.3          13.10     29.8   \n",
       "2                39.75             37.05         76.3          14.15     35.2   \n",
       "3                30.00             30.80         78.3          11.90     32.3   \n",
       "4                36.00             36.40         75.6          12.60     29.3   \n",
       "\n",
       "   physical_health  physical_inactivity  sleep_lt_7_hours  stroke  \\\n",
       "0            11.80                24.40              37.9    3.10   \n",
       "1            13.60                26.00              40.6    3.80   \n",
       "2            14.25                27.25              37.2    4.25   \n",
       "3            11.40                26.90              39.4    2.90   \n",
       "4            14.00                28.50              35.6    4.10   \n",
       "\n",
       "   taking_bp_medication  teeth_loss  ma_penetration_2020  ma_penetration_2021  \\\n",
       "0                 73.00       11.70                47.51                49.70   \n",
       "1                 75.00       14.40                59.36                61.51   \n",
       "2                 78.65       18.25                42.63                47.52   \n",
       "3                 75.80       12.60                47.57                51.14   \n",
       "4                 77.20       13.80                42.39                44.41   \n",
       "\n",
       "   delta_ma_enrolled  delta_ma_penetration_points    event_time  \\\n",
       "0             2804.0                         2.19  1.636493e+09   \n",
       "1            11563.0                         2.15  1.636493e+09   \n",
       "2              864.0                         4.89  1.636493e+09   \n",
       "3             5919.0                         3.57  1.636493e+09   \n",
       "4             9991.0                         2.02  1.636493e+09   \n",
       "\n",
       "               write_time api_invocation_time is_deleted  \n",
       "0 2021-11-09 21:28:53.888 2021-11-09 21:24:11      False  \n",
       "1 2021-11-09 21:28:53.842 2021-11-09 21:26:16      False  \n",
       "2 2021-11-09 21:28:54.121 2021-11-09 21:26:11      False  \n",
       "3 2021-11-09 21:28:54.929 2021-11-09 21:25:48      False  \n",
       "4 2021-11-09 21:28:53.878 2021-11-09 21:26:31      False  "
      ]
     },
     "execution_count": 11,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df_brokerage_agent_sales['postal_code'] = pd.to_numeric(df_brokerage_agent_sales['postal_code'].str[:5], errors='coerce').astype('Int64')\n",
    "df_brokerage_agent_sales = df_brokerage_agent_sales.dropna(subset=['postal_code'])\n",
    "\n",
    "df_brokerage_sales_zipcode = df_brokerage_agent_sales.merge(df_zipcode_feature, how='left', right_on='zipcode', left_on='postal_code', suffixes=('', '_zip'))\n",
    "print(df_brokerage_sales_zipcode.shape)\n",
    "df_brokerage_sales_zipcode.head()"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# Add TU Agent Info"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "metadata": {},
   "outputs": [],
   "source": [
    "def query_transunion(params):\n",
    "    headers={\n",
    "        'Content-type':'application/json', \n",
    "        'Accept':'application/json'\n",
    "    }\n",
    "\n",
    "    url = 'https://api.healthcare.com/third-party/api/v1/third-parties/transunion'\n",
    "    json_object = json.dumps(params)\n",
    "    response = requests.post(url=url, headers=headers, data=json_object)\n",
    "    response_json = json.loads(response.text)\n",
    "    \n",
    "    if 'transaction' in response_json.keys():\n",
    "        if 'output' in response_json['transaction'].keys():\n",
    "            return response_json['transaction']['output']\n",
    "    return None"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 13,
   "metadata": {},
   "outputs": [],
   "source": [
    "def process_tu_lead(lead):\n",
    "    if lead is None:\n",
    "        return {}\n",
    "    personal_data = lead.get('data')\n",
    "    personal_variables = ['email', 'phone', 'first', 'last', 'city', 'state', 'zip']\n",
    "\n",
    "    personal_output = {}\n",
    "\n",
    "    if personal_data:\n",
    "        for personal_variable in personal_variables:\n",
    "            personal_variable_output = personal_data.get(personal_variable)\n",
    "            if personal_variable_output:\n",
    "                personal_variable_output = personal_variable_output.lower()\n",
    "            personal_output[personal_variable] = personal_variable_output\n",
    "        if personal_output['zip']:\n",
    "            personal_output['zip'] = personal_output['zip'][:5]\n",
    "\n",
    "    demo = lead.get('demo')\n",
    "    demo_variables = [('age', 'years'), ('income', 'dollars'), ('children', 'yes'), ('education', 'years'),\n",
    "                     ('homeowner', 'yes'), ('homevalue', 'dollars'), ('resident', 'years'),\n",
    "                     ('occupation', 'first'), ('affiliation', 'conservative'), ('affiliation', 'liberal')]\n",
    "\n",
    "    demo_output = {}\n",
    "\n",
    "    if demo:\n",
    "        for demo_var in demo_variables:\n",
    "            keys = set(demo.keys())\n",
    "\n",
    "            var_name = demo_var[0]\n",
    "            sub_var_name = demo_var[1]\n",
    "            if var_name in keys:\n",
    "                demo_output[f'{var_name}_{sub_var_name}'] = demo[var_name].get(sub_var_name)\n",
    "\n",
    "    demo_output.update(personal_output)\n",
    "\n",
    "    scores = lead.get('score')\n",
    "    scores_output = {}\n",
    "    if scores:\n",
    "        for score in scores:\n",
    "            score_name = score.get('name')\n",
    "            score_number = score.get('score')\n",
    "\n",
    "            scores_output[score_name] = int(score_number)\n",
    "\n",
    "\n",
    "    demo_output.update(scores_output)\n",
    "    \n",
    "    return {k+'_tu': v for k, v in demo_output.items()}"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 14,
   "metadata": {},
   "outputs": [],
   "source": [
    "def query_process_tu(email, mobile_phone, phone, dob, name, zipcode):\n",
    "    params = {\n",
    "        'email': email,\n",
    "        'phone': phone if phone else mobile_phone,\n",
    "        'dob': dob.strftime('%Y-%m-%d') if pd.notnull(dob) else '',\n",
    "        'first_name': name,\n",
    "        'zipcode': zipcode\n",
    "    }\n",
    "    lead = query_transunion(params)\n",
    "    processed_lead = process_tu_lead(lead)\n",
    "    return processed_lead"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 15,
   "metadata": {},
   "outputs": [],
   "source": [
    "df_agents_tu = df_brokerage_sales_zipcode.apply(lambda row : query_process_tu(row['agent_email'], row['mobile_phone'], row['phone'], \n",
    "                                                                        row['birthdate'], row['name'], row['postal_code']), axis = 1, result_type='expand')\n",
    "df_agents_tu_merged = pd.concat([df_brokerage_sales_zipcode, df_agents_tu], axis='columns')\n",
    "# df_agents_tu_merged = df_brokerage_agent_sales"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 16,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "agency_name                                 83.553049\n",
       "email                                       78.901001\n",
       "mobile_phone                                76.055267\n",
       "affiliation_conservative_tu                 72.030676\n",
       "affiliation_liberal_tu                      72.030676\n",
       "email_tu                                    66.123717\n",
       "occupation_first_tu                         53.625301\n",
       "termination_date                            50.494359\n",
       "homevalue_dollars_tu                        43.262771\n",
       "monthly_sales_goal                          42.413487\n",
       "first_tu                                    37.019901\n",
       "age_years_tu                                36.709342\n",
       "resident_years_tu                           34.472050\n",
       "education_years_tu                          34.415008\n",
       "income_dollars_tu                           34.294587\n",
       "homeowner_yes_tu                            34.288249\n",
       "children_yes_tu                             34.288249\n",
       "phone_tu                                    31.569274\n",
       "last_tu                                     26.182026\n",
       "zip_tu                                      26.118646\n",
       "city_tu                                     26.067943\n",
       "state_tu                                    26.067943\n",
       "ebureau-score-market-201801220508_tu        25.991887\n",
       "ebureau-score-market-201805170506_tu        25.991887\n",
       "percentage_sales                            19.064520\n",
       "expiration_date                              9.532260\n",
       "radius_in_miles                              3.283052\n",
       "occupied_housing_units                       3.283052\n",
       "housing_units                                3.283052\n",
       "water_area_in_sqmi                           3.283052\n",
       "land_area_in_sqmi                            3.283052\n",
       "annual_checkup                               3.206997\n",
       "population                                   2.547851\n",
       "binge_drinking                               2.547851\n",
       "arthritis                                    2.547851\n",
       "median_household_income                      2.547851\n",
       "delta_ma_penetration_points                  2.547851\n",
       "population_density                           2.547851\n",
       "delta_ma_enrolled                            2.547851\n",
       "cancer_except_skin                           2.547851\n",
       "timezone                                     2.547851\n",
       "lng                                          2.547851\n",
       "lat                                          2.547851\n",
       "state_zip                                    2.547851\n",
       "ma_penetration_2021                          2.547851\n",
       "event_time                                   2.547851\n",
       "write_time                                   2.547851\n",
       "api_invocation_time                          2.547851\n",
       "is_deleted                                   2.547851\n",
       "copd                                         2.547851\n",
       "zipcode                                      2.547851\n",
       "cervical_cancer_screening                    2.547851\n",
       "high_cholesterol                             2.547851\n",
       "ma_penetration_2020                          2.547851\n",
       "teeth_loss                                   2.547851\n",
       "taking_bp_medication                         2.547851\n",
       "cholesterol_screening                        2.547851\n",
       "sleep_lt_7_hours                             2.547851\n",
       "physical_inactivity                          2.547851\n",
       "physical_health                              2.547851\n",
       "obesity                                      2.547851\n",
       "mental_health                                2.547851\n",
       "mammography                                  2.547851\n",
       "stroke                                       2.547851\n",
       "high_blood_pressure                          2.547851\n",
       "coronary_heart_disease                       2.547851\n",
       "chronic_kidney_disease                       2.547851\n",
       "health_insurance                             2.547851\n",
       "colorectal_cancer_screening                  2.547851\n",
       "core_preventive_services_for_older_men       2.547851\n",
       "core_preventive_services_for_older_women     2.547851\n",
       "median_home_value                            2.547851\n",
       "dental_visit                                 2.547851\n",
       "current_asthma                               2.547851\n",
       "diabetes                                     2.547851\n",
       "current_smoking                              2.547851\n",
       "npn                                          2.142223\n",
       "product_classification                       0.766891\n",
       "carrier                                      0.209152\n",
       "zip                                          0.209152\n",
       "city                                         0.209152\n",
       "payment_type                                 0.209152\n",
       "agent                                        0.152111\n",
       "revenue_eltv                                 0.076055\n",
       "birthdate                                    0.076055\n",
       "premium_eltv                                 0.076055\n",
       "estimated_observed_duration                  0.076055\n",
       "is_agency                                    0.000000\n",
       "is_test                                      0.000000\n",
       "sales_channel                                0.000000\n",
       "is_active                                    0.000000\n",
       "enrollment_status                            0.000000\n",
       "agent_email                                  0.000000\n",
       "agent_city                                   0.000000\n",
       "channel                                      0.000000\n",
       "agent_type                                   0.000000\n",
       "agent_created_date                           0.000000\n",
       "name                                         0.000000\n",
       "agent_id                                     0.000000\n",
       "phone                                        0.000000\n",
       "pivot_id                                     0.000000\n",
       "postal_code                                  0.000000\n",
       "agent_state                                  0.000000\n",
       "agency_id                                    0.000000\n",
       "date_created                                 0.000000\n",
       "effective_date                               0.000000\n",
       "monthly_premium                              0.000000\n",
       "state                                        0.000000\n",
       "plan_name                                    0.000000\n",
       "plan_tier                                    0.000000\n",
       "policy_id                                    0.000000\n",
       "product_type                                 0.000000\n",
       "duration_category                            0.000000\n",
       "dtype: float64"
      ]
     },
     "execution_count": 16,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df_agents_tu_merged.isnull().sum().sort_values(ascending=False) / df_agents_tu_merged.shape[0] * 100"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# Store CSV in S3"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 17,
   "metadata": {},
   "outputs": [],
   "source": [
    "s3_bucket = 'hc-data-science'\n",
    "object_key = f\"brokerage-agent-recruiting/sales_view-tu.csv\"\n",
    "data_location = 's3://{}/{}'.format(s3_bucket, object_key)\n",
    "df_agents_tu_merged.to_csv(data_location, index=False)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 18,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "(15778, 113)\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>agency_name</th>\n",
       "      <th>agent_created_date</th>\n",
       "      <th>agent_type</th>\n",
       "      <th>birthdate</th>\n",
       "      <th>channel</th>\n",
       "      <th>agent_city</th>\n",
       "      <th>agent_email</th>\n",
       "      <th>enrollment_status</th>\n",
       "      <th>is_active</th>\n",
       "      <th>is_agency</th>\n",
       "      <th>is_test</th>\n",
       "      <th>mobile_phone</th>\n",
       "      <th>name</th>\n",
       "      <th>npn</th>\n",
       "      <th>phone</th>\n",
       "      <th>pivot_id</th>\n",
       "      <th>postal_code</th>\n",
       "      <th>agent_state</th>\n",
       "      <th>agency_id</th>\n",
       "      <th>agent</th>\n",
       "      <th>agent_id</th>\n",
       "      <th>carrier</th>\n",
       "      <th>city</th>\n",
       "      <th>date_created</th>\n",
       "      <th>duration_category</th>\n",
       "      <th>effective_date</th>\n",
       "      <th>email</th>\n",
       "      <th>estimated_observed_duration</th>\n",
       "      <th>expiration_date</th>\n",
       "      <th>monthly_premium</th>\n",
       "      <th>monthly_sales_goal</th>\n",
       "      <th>payment_type</th>\n",
       "      <th>percentage_sales</th>\n",
       "      <th>plan_name</th>\n",
       "      <th>plan_tier</th>\n",
       "      <th>policy_id</th>\n",
       "      <th>premium_eltv</th>\n",
       "      <th>product_classification</th>\n",
       "      <th>product_type</th>\n",
       "      <th>revenue_eltv</th>\n",
       "      <th>sales_channel</th>\n",
       "      <th>state</th>\n",
       "      <th>termination_date</th>\n",
       "      <th>zip</th>\n",
       "      <th>zipcode</th>\n",
       "      <th>state_zip</th>\n",
       "      <th>lat</th>\n",
       "      <th>lng</th>\n",
       "      <th>timezone</th>\n",
       "      <th>radius_in_miles</th>\n",
       "      <th>population</th>\n",
       "      <th>population_density</th>\n",
       "      <th>land_area_in_sqmi</th>\n",
       "      <th>water_area_in_sqmi</th>\n",
       "      <th>housing_units</th>\n",
       "      <th>occupied_housing_units</th>\n",
       "      <th>median_home_value</th>\n",
       "      <th>median_household_income</th>\n",
       "      <th>annual_checkup</th>\n",
       "      <th>arthritis</th>\n",
       "      <th>binge_drinking</th>\n",
       "      <th>copd</th>\n",
       "      <th>cancer_except_skin</th>\n",
       "      <th>cervical_cancer_screening</th>\n",
       "      <th>cholesterol_screening</th>\n",
       "      <th>chronic_kidney_disease</th>\n",
       "      <th>colorectal_cancer_screening</th>\n",
       "      <th>core_preventive_services_for_older_men</th>\n",
       "      <th>core_preventive_services_for_older_women</th>\n",
       "      <th>coronary_heart_disease</th>\n",
       "      <th>current_asthma</th>\n",
       "      <th>current_smoking</th>\n",
       "      <th>dental_visit</th>\n",
       "      <th>diabetes</th>\n",
       "      <th>health_insurance</th>\n",
       "      <th>high_blood_pressure</th>\n",
       "      <th>high_cholesterol</th>\n",
       "      <th>mammography</th>\n",
       "      <th>mental_health</th>\n",
       "      <th>obesity</th>\n",
       "      <th>physical_health</th>\n",
       "      <th>physical_inactivity</th>\n",
       "      <th>sleep_lt_7_hours</th>\n",
       "      <th>stroke</th>\n",
       "      <th>taking_bp_medication</th>\n",
       "      <th>teeth_loss</th>\n",
       "      <th>ma_penetration_2020</th>\n",
       "      <th>ma_penetration_2021</th>\n",
       "      <th>delta_ma_enrolled</th>\n",
       "      <th>delta_ma_penetration_points</th>\n",
       "      <th>event_time</th>\n",
       "      <th>write_time</th>\n",
       "      <th>api_invocation_time</th>\n",
       "      <th>is_deleted</th>\n",
       "      <th>age_years_tu</th>\n",
       "      <th>income_dollars_tu</th>\n",
       "      <th>children_yes_tu</th>\n",
       "      <th>education_years_tu</th>\n",
       "      <th>homeowner_yes_tu</th>\n",
       "      <th>homevalue_dollars_tu</th>\n",
       "      <th>resident_years_tu</th>\n",
       "      <th>occupation_first_tu</th>\n",
       "      <th>affiliation_conservative_tu</th>\n",
       "      <th>affiliation_liberal_tu</th>\n",
       "      <th>email_tu</th>\n",
       "      <th>phone_tu</th>\n",
       "      <th>first_tu</th>\n",
       "      <th>last_tu</th>\n",
       "      <th>city_tu</th>\n",
       "      <th>state_tu</th>\n",
       "      <th>zip_tu</th>\n",
       "      <th>ebureau-score-market-201801220508_tu</th>\n",
       "      <th>ebureau-score-market-201805170506_tu</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>NaN</td>\n",
       "      <td>2021-05-04 00:00:00.000</td>\n",
       "      <td>Brokerage Agent</td>\n",
       "      <td>1971-06-28 00:00:00.000</td>\n",
       "      <td>Brokerage</td>\n",
       "      <td>Lake Mary</td>\n",
       "      <td>cimacare@yahoo.com</td>\n",
       "      <td>Completed</td>\n",
       "      <td>True</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Kattia Santamaria</td>\n",
       "      <td>NaN</td>\n",
       "      <td>888-693-0431</td>\n",
       "      <td>61522</td>\n",
       "      <td>32746</td>\n",
       "      <td>FL</td>\n",
       "      <td>58649</td>\n",
       "      <td>Kattia Santamaria</td>\n",
       "      <td>61522</td>\n",
       "      <td>CLIC</td>\n",
       "      <td>Castroville</td>\n",
       "      <td>2021-01-01 00:00:00.000</td>\n",
       "      <td>364x1</td>\n",
       "      <td>2021-01-02 00:00:00.000</td>\n",
       "      <td>cimacare@yahoo.com</td>\n",
       "      <td>7.93</td>\n",
       "      <td>2021-12-31 00:00:00.000</td>\n",
       "      <td>47.59</td>\n",
       "      <td>100.0</td>\n",
       "      <td>CC</td>\n",
       "      <td>45.0</td>\n",
       "      <td>Companion Economy</td>\n",
       "      <td>Companion Economy</td>\n",
       "      <td>338812</td>\n",
       "      <td>114.160082</td>\n",
       "      <td>U65 Major Medical</td>\n",
       "      <td>STM</td>\n",
       "      <td>185.553237</td>\n",
       "      <td>Brokerage</td>\n",
       "      <td>TX</td>\n",
       "      <td>2021-12-31 00:00:00.000</td>\n",
       "      <td>78009.0</td>\n",
       "      <td>32746.0</td>\n",
       "      <td>FL</td>\n",
       "      <td>28.7577</td>\n",
       "      <td>-81.3508</td>\n",
       "      <td>Eastern</td>\n",
       "      <td>4.0</td>\n",
       "      <td>40571.0</td>\n",
       "      <td>1838.0</td>\n",
       "      <td>22.07</td>\n",
       "      <td>1.50</td>\n",
       "      <td>17700.0</td>\n",
       "      <td>15986.0</td>\n",
       "      <td>245100.0</td>\n",
       "      <td>75344.0</td>\n",
       "      <td>77.90</td>\n",
       "      <td>25.3</td>\n",
       "      <td>17.90</td>\n",
       "      <td>6.80</td>\n",
       "      <td>6.8</td>\n",
       "      <td>85.3</td>\n",
       "      <td>82.1</td>\n",
       "      <td>2.80</td>\n",
       "      <td>67.40</td>\n",
       "      <td>31.6</td>\n",
       "      <td>31.3</td>\n",
       "      <td>6.5</td>\n",
       "      <td>8.30</td>\n",
       "      <td>15.90</td>\n",
       "      <td>65.60</td>\n",
       "      <td>10.9</td>\n",
       "      <td>19.1</td>\n",
       "      <td>32.10</td>\n",
       "      <td>34.20</td>\n",
       "      <td>75.7</td>\n",
       "      <td>12.80</td>\n",
       "      <td>27.8</td>\n",
       "      <td>11.80</td>\n",
       "      <td>24.40</td>\n",
       "      <td>37.9</td>\n",
       "      <td>3.10</td>\n",
       "      <td>73.00</td>\n",
       "      <td>11.70</td>\n",
       "      <td>47.51</td>\n",
       "      <td>49.70</td>\n",
       "      <td>2804.0</td>\n",
       "      <td>2.19</td>\n",
       "      <td>1.636493e+09</td>\n",
       "      <td>2021-11-09 21:28:53.888</td>\n",
       "      <td>2021-11-09 21:24:11.000</td>\n",
       "      <td>False</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>NaN</td>\n",
       "      <td>2021-05-04 00:00:00.000</td>\n",
       "      <td>Brokerage Agent</td>\n",
       "      <td>1992-07-03 00:00:00.000</td>\n",
       "      <td>Brokerage</td>\n",
       "      <td>Cooper City</td>\n",
       "      <td>odeameaghan123@outlook.com</td>\n",
       "      <td>Completed</td>\n",
       "      <td>True</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Meagan O'Dea</td>\n",
       "      <td>18425849</td>\n",
       "      <td>954-600-7392</td>\n",
       "      <td>68781</td>\n",
       "      <td>33328</td>\n",
       "      <td>FL</td>\n",
       "      <td>62967</td>\n",
       "      <td>Meagan Jimenez</td>\n",
       "      <td>68781</td>\n",
       "      <td>CLIC</td>\n",
       "      <td>Melbourne</td>\n",
       "      <td>2021-01-05 00:00:00.000</td>\n",
       "      <td>364x1</td>\n",
       "      <td>2021-01-15 00:00:00.000</td>\n",
       "      <td>NaN</td>\n",
       "      <td>7.93</td>\n",
       "      <td>2022-01-13 00:00:00.000</td>\n",
       "      <td>174.70</td>\n",
       "      <td>NaN</td>\n",
       "      <td>ACH</td>\n",
       "      <td>45.0</td>\n",
       "      <td>Companion Quantum</td>\n",
       "      <td>Companion Quantum</td>\n",
       "      <td>339579</td>\n",
       "      <td>419.074727</td>\n",
       "      <td>U65 Major Medical</td>\n",
       "      <td>STM</td>\n",
       "      <td>523.025711</td>\n",
       "      <td>Brokerage</td>\n",
       "      <td>FL</td>\n",
       "      <td>2022-01-13 00:00:00.000</td>\n",
       "      <td>32935.0</td>\n",
       "      <td>33328.0</td>\n",
       "      <td>FL</td>\n",
       "      <td>26.0671</td>\n",
       "      <td>-80.2723</td>\n",
       "      <td>Eastern</td>\n",
       "      <td>2.0</td>\n",
       "      <td>27415.0</td>\n",
       "      <td>2916.0</td>\n",
       "      <td>9.40</td>\n",
       "      <td>0.08</td>\n",
       "      <td>10431.0</td>\n",
       "      <td>9956.0</td>\n",
       "      <td>284200.0</td>\n",
       "      <td>78566.0</td>\n",
       "      <td>79.70</td>\n",
       "      <td>23.8</td>\n",
       "      <td>15.80</td>\n",
       "      <td>7.40</td>\n",
       "      <td>6.9</td>\n",
       "      <td>84.4</td>\n",
       "      <td>83.3</td>\n",
       "      <td>3.30</td>\n",
       "      <td>64.60</td>\n",
       "      <td>26.7</td>\n",
       "      <td>27.4</td>\n",
       "      <td>7.3</td>\n",
       "      <td>8.70</td>\n",
       "      <td>16.50</td>\n",
       "      <td>64.40</td>\n",
       "      <td>13.1</td>\n",
       "      <td>23.9</td>\n",
       "      <td>35.20</td>\n",
       "      <td>34.30</td>\n",
       "      <td>74.3</td>\n",
       "      <td>13.10</td>\n",
       "      <td>29.8</td>\n",
       "      <td>13.60</td>\n",
       "      <td>26.00</td>\n",
       "      <td>40.6</td>\n",
       "      <td>3.80</td>\n",
       "      <td>75.00</td>\n",
       "      <td>14.40</td>\n",
       "      <td>59.36</td>\n",
       "      <td>61.51</td>\n",
       "      <td>11563.0</td>\n",
       "      <td>2.15</td>\n",
       "      <td>1.636493e+09</td>\n",
       "      <td>2021-11-09 21:28:53.842</td>\n",
       "      <td>2021-11-09 21:26:16.000</td>\n",
       "      <td>False</td>\n",
       "      <td>43.6</td>\n",
       "      <td>88000.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>13.0</td>\n",
       "      <td>100.0</td>\n",
       "      <td>285000.0</td>\n",
       "      <td>10.4</td>\n",
       "      <td>whitecollar</td>\n",
       "      <td>50.0</td>\n",
       "      <td>50.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>9.546007e+09</td>\n",
       "      <td>NaN</td>\n",
       "      <td>odea</td>\n",
       "      <td>cooper city</td>\n",
       "      <td>fl</td>\n",
       "      <td>33328.0</td>\n",
       "      <td>398.0</td>\n",
       "      <td>507.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>NaN</td>\n",
       "      <td>2021-05-04 00:00:00.000</td>\n",
       "      <td>Brokerage Agent</td>\n",
       "      <td>1985-01-18 00:00:00.000</td>\n",
       "      <td>Brokerage</td>\n",
       "      <td>Franklinton</td>\n",
       "      <td>suikhamh@yahoo.com</td>\n",
       "      <td>Completed</td>\n",
       "      <td>True</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Sui Cer Khamh</td>\n",
       "      <td>19017372</td>\n",
       "      <td>919-916-0937</td>\n",
       "      <td>70765</td>\n",
       "      <td>27525</td>\n",
       "      <td>NC</td>\n",
       "      <td>70765</td>\n",
       "      <td>Sui Cer Khamh</td>\n",
       "      <td>70765</td>\n",
       "      <td>NRIC</td>\n",
       "      <td>Indianapolis</td>\n",
       "      <td>2021-01-07 00:00:00.000</td>\n",
       "      <td>364x1</td>\n",
       "      <td>2021-01-08 00:00:00.000</td>\n",
       "      <td>NaN</td>\n",
       "      <td>7.93</td>\n",
       "      <td>2022-01-06 00:00:00.000</td>\n",
       "      <td>67.56</td>\n",
       "      <td>NaN</td>\n",
       "      <td>CC</td>\n",
       "      <td>45.0</td>\n",
       "      <td>EPIC BASE Plan</td>\n",
       "      <td>North River Base</td>\n",
       "      <td>340130</td>\n",
       "      <td>139.295208</td>\n",
       "      <td>U65 Major Medical</td>\n",
       "      <td>STM</td>\n",
       "      <td>211.838459</td>\n",
       "      <td>Brokerage</td>\n",
       "      <td>IN</td>\n",
       "      <td>2021-02-07 00:00:00.000</td>\n",
       "      <td>46227.0</td>\n",
       "      <td>27525.0</td>\n",
       "      <td>NC</td>\n",
       "      <td>36.0955</td>\n",
       "      <td>-78.4486</td>\n",
       "      <td>Eastern</td>\n",
       "      <td>9.0</td>\n",
       "      <td>13338.0</td>\n",
       "      <td>144.0</td>\n",
       "      <td>92.51</td>\n",
       "      <td>0.29</td>\n",
       "      <td>5797.0</td>\n",
       "      <td>5172.0</td>\n",
       "      <td>129100.0</td>\n",
       "      <td>43090.0</td>\n",
       "      <td>80.15</td>\n",
       "      <td>29.7</td>\n",
       "      <td>14.55</td>\n",
       "      <td>8.75</td>\n",
       "      <td>7.4</td>\n",
       "      <td>85.4</td>\n",
       "      <td>80.7</td>\n",
       "      <td>3.45</td>\n",
       "      <td>66.75</td>\n",
       "      <td>35.3</td>\n",
       "      <td>36.0</td>\n",
       "      <td>8.1</td>\n",
       "      <td>10.05</td>\n",
       "      <td>20.55</td>\n",
       "      <td>62.35</td>\n",
       "      <td>13.8</td>\n",
       "      <td>19.0</td>\n",
       "      <td>39.75</td>\n",
       "      <td>37.05</td>\n",
       "      <td>76.3</td>\n",
       "      <td>14.15</td>\n",
       "      <td>35.2</td>\n",
       "      <td>14.25</td>\n",
       "      <td>27.25</td>\n",
       "      <td>37.2</td>\n",
       "      <td>4.25</td>\n",
       "      <td>78.65</td>\n",
       "      <td>18.25</td>\n",
       "      <td>42.63</td>\n",
       "      <td>47.52</td>\n",
       "      <td>864.0</td>\n",
       "      <td>4.89</td>\n",
       "      <td>1.636493e+09</td>\n",
       "      <td>2021-11-09 21:28:54.121</td>\n",
       "      <td>2021-11-09 21:26:11.000</td>\n",
       "      <td>False</td>\n",
       "      <td>41.4</td>\n",
       "      <td>133000.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>14.0</td>\n",
       "      <td>100.0</td>\n",
       "      <td>350000.0</td>\n",
       "      <td>8.9</td>\n",
       "      <td>execuppermanagement</td>\n",
       "      <td>100.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>suikhamh@yahoo.com</td>\n",
       "      <td>9.199161e+09</td>\n",
       "      <td>sui cer</td>\n",
       "      <td>khamh</td>\n",
       "      <td>frisco</td>\n",
       "      <td>tx</td>\n",
       "      <td>75035.0</td>\n",
       "      <td>49.0</td>\n",
       "      <td>573.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>NaN</td>\n",
       "      <td>2021-05-04 00:00:00.000</td>\n",
       "      <td>Brokerage Agent</td>\n",
       "      <td>1962-11-16 00:00:00.000</td>\n",
       "      <td>Brokerage</td>\n",
       "      <td>Lawrence</td>\n",
       "      <td>lat@milnergroup.com</td>\n",
       "      <td>Completed</td>\n",
       "      <td>True</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Willis (Lat) Milner</td>\n",
       "      <td>1023744</td>\n",
       "      <td>678-252-1776</td>\n",
       "      <td>63783</td>\n",
       "      <td>30043</td>\n",
       "      <td>GA</td>\n",
       "      <td>60436</td>\n",
       "      <td>Willis (Lat) Milner</td>\n",
       "      <td>63783</td>\n",
       "      <td>NRIC</td>\n",
       "      <td>Atlanta</td>\n",
       "      <td>2021-01-13 00:00:00.000</td>\n",
       "      <td>180x2</td>\n",
       "      <td>2021-01-20 00:00:00.000</td>\n",
       "      <td>NaN</td>\n",
       "      <td>7.93</td>\n",
       "      <td>2022-01-14 00:00:00.000</td>\n",
       "      <td>228.48</td>\n",
       "      <td>NaN</td>\n",
       "      <td>CC</td>\n",
       "      <td>15.0</td>\n",
       "      <td>EPIC BASE Plan</td>\n",
       "      <td>North River Base</td>\n",
       "      <td>341476</td>\n",
       "      <td>543.553920</td>\n",
       "      <td>U65 Major Medical</td>\n",
       "      <td>STM</td>\n",
       "      <td>657.315059</td>\n",
       "      <td>Brokerage</td>\n",
       "      <td>GA</td>\n",
       "      <td>2021-07-18 00:00:00.000</td>\n",
       "      <td>30326.0</td>\n",
       "      <td>30043.0</td>\n",
       "      <td>GA</td>\n",
       "      <td>34.0031</td>\n",
       "      <td>-84.0126</td>\n",
       "      <td>Eastern</td>\n",
       "      <td>6.0</td>\n",
       "      <td>80241.0</td>\n",
       "      <td>2467.0</td>\n",
       "      <td>32.53</td>\n",
       "      <td>0.39</td>\n",
       "      <td>27767.0</td>\n",
       "      <td>25997.0</td>\n",
       "      <td>171000.0</td>\n",
       "      <td>67260.0</td>\n",
       "      <td>76.70</td>\n",
       "      <td>21.1</td>\n",
       "      <td>15.50</td>\n",
       "      <td>5.80</td>\n",
       "      <td>5.5</td>\n",
       "      <td>83.4</td>\n",
       "      <td>82.8</td>\n",
       "      <td>2.70</td>\n",
       "      <td>62.70</td>\n",
       "      <td>30.9</td>\n",
       "      <td>35.6</td>\n",
       "      <td>5.6</td>\n",
       "      <td>8.60</td>\n",
       "      <td>14.10</td>\n",
       "      <td>61.30</td>\n",
       "      <td>11.2</td>\n",
       "      <td>23.6</td>\n",
       "      <td>30.00</td>\n",
       "      <td>30.80</td>\n",
       "      <td>78.3</td>\n",
       "      <td>11.90</td>\n",
       "      <td>32.3</td>\n",
       "      <td>11.40</td>\n",
       "      <td>26.90</td>\n",
       "      <td>39.4</td>\n",
       "      <td>2.90</td>\n",
       "      <td>75.80</td>\n",
       "      <td>12.60</td>\n",
       "      <td>47.57</td>\n",
       "      <td>51.14</td>\n",
       "      <td>5919.0</td>\n",
       "      <td>3.57</td>\n",
       "      <td>1.636493e+09</td>\n",
       "      <td>2021-11-09 21:28:54.929</td>\n",
       "      <td>2021-11-09 21:25:48.000</td>\n",
       "      <td>False</td>\n",
       "      <td>52.7</td>\n",
       "      <td>150000.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>15.0</td>\n",
       "      <td>100.0</td>\n",
       "      <td>333333.0</td>\n",
       "      <td>20.8</td>\n",
       "      <td>whitecollar</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>lat@milnergroup.com</td>\n",
       "      <td>6.782522e+09</td>\n",
       "      <td>NaN</td>\n",
       "      <td>milner</td>\n",
       "      <td>cherry hill</td>\n",
       "      <td>nj</td>\n",
       "      <td>8003.0</td>\n",
       "      <td>27.0</td>\n",
       "      <td>590.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>NaN</td>\n",
       "      <td>2021-05-04 00:00:00.000</td>\n",
       "      <td>Brokerage Agent</td>\n",
       "      <td>1987-12-14 00:00:00.000</td>\n",
       "      <td>Brokerage</td>\n",
       "      <td>Boca Raton</td>\n",
       "      <td>aahealthagency@outlook.com</td>\n",
       "      <td>Completed</td>\n",
       "      <td>True</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Nicole Connolly</td>\n",
       "      <td>18245457</td>\n",
       "      <td>800-214-0714</td>\n",
       "      <td>60767</td>\n",
       "      <td>33431</td>\n",
       "      <td>FL</td>\n",
       "      <td>57387</td>\n",
       "      <td>Nicole Connolly</td>\n",
       "      <td>60767</td>\n",
       "      <td>CLIC</td>\n",
       "      <td>Plano</td>\n",
       "      <td>2021-01-15 00:00:00.000</td>\n",
       "      <td>180x1</td>\n",
       "      <td>2021-01-16 00:00:00.000</td>\n",
       "      <td>NaN</td>\n",
       "      <td>4.17</td>\n",
       "      <td>2021-07-14 00:00:00.000</td>\n",
       "      <td>692.43</td>\n",
       "      <td>500.0</td>\n",
       "      <td>ACH</td>\n",
       "      <td>40.0</td>\n",
       "      <td>Companion Core</td>\n",
       "      <td>Companion Core</td>\n",
       "      <td>341986</td>\n",
       "      <td>873.448513</td>\n",
       "      <td>U65 Major Medical</td>\n",
       "      <td>STM</td>\n",
       "      <td>1007.304102</td>\n",
       "      <td>Brokerage</td>\n",
       "      <td>TX</td>\n",
       "      <td>2021-07-14 00:00:00.000</td>\n",
       "      <td>75023.0</td>\n",
       "      <td>33431.0</td>\n",
       "      <td>FL</td>\n",
       "      <td>26.3799</td>\n",
       "      <td>-80.0975</td>\n",
       "      <td>Eastern</td>\n",
       "      <td>3.0</td>\n",
       "      <td>18290.0</td>\n",
       "      <td>2057.0</td>\n",
       "      <td>8.89</td>\n",
       "      <td>0.77</td>\n",
       "      <td>8375.0</td>\n",
       "      <td>6896.0</td>\n",
       "      <td>295600.0</td>\n",
       "      <td>67500.0</td>\n",
       "      <td>80.40</td>\n",
       "      <td>28.0</td>\n",
       "      <td>16.30</td>\n",
       "      <td>8.50</td>\n",
       "      <td>8.7</td>\n",
       "      <td>85.7</td>\n",
       "      <td>84.2</td>\n",
       "      <td>3.60</td>\n",
       "      <td>66.60</td>\n",
       "      <td>32.8</td>\n",
       "      <td>30.6</td>\n",
       "      <td>8.6</td>\n",
       "      <td>8.30</td>\n",
       "      <td>15.20</td>\n",
       "      <td>65.70</td>\n",
       "      <td>13.6</td>\n",
       "      <td>21.9</td>\n",
       "      <td>36.00</td>\n",
       "      <td>36.40</td>\n",
       "      <td>75.6</td>\n",
       "      <td>12.60</td>\n",
       "      <td>29.3</td>\n",
       "      <td>14.00</td>\n",
       "      <td>28.50</td>\n",
       "      <td>35.6</td>\n",
       "      <td>4.10</td>\n",
       "      <td>77.20</td>\n",
       "      <td>13.80</td>\n",
       "      <td>42.39</td>\n",
       "      <td>44.41</td>\n",
       "      <td>9991.0</td>\n",
       "      <td>2.02</td>\n",
       "      <td>1.636493e+09</td>\n",
       "      <td>2021-11-09 21:28:53.878</td>\n",
       "      <td>2021-11-09 21:26:31.000</td>\n",
       "      <td>False</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "  agency_name       agent_created_date       agent_type  \\\n",
       "0         NaN  2021-05-04 00:00:00.000  Brokerage Agent   \n",
       "1         NaN  2021-05-04 00:00:00.000  Brokerage Agent   \n",
       "2         NaN  2021-05-04 00:00:00.000  Brokerage Agent   \n",
       "3         NaN  2021-05-04 00:00:00.000  Brokerage Agent   \n",
       "4         NaN  2021-05-04 00:00:00.000  Brokerage Agent   \n",
       "\n",
       "                 birthdate    channel   agent_city  \\\n",
       "0  1971-06-28 00:00:00.000  Brokerage    Lake Mary   \n",
       "1  1992-07-03 00:00:00.000  Brokerage  Cooper City   \n",
       "2  1985-01-18 00:00:00.000  Brokerage  Franklinton   \n",
       "3  1962-11-16 00:00:00.000  Brokerage     Lawrence   \n",
       "4  1987-12-14 00:00:00.000  Brokerage   Boca Raton   \n",
       "\n",
       "                  agent_email enrollment_status  is_active  is_agency  \\\n",
       "0          cimacare@yahoo.com         Completed       True      False   \n",
       "1  odeameaghan123@outlook.com         Completed       True      False   \n",
       "2          suikhamh@yahoo.com         Completed       True      False   \n",
       "3         lat@milnergroup.com         Completed       True      False   \n",
       "4  aahealthagency@outlook.com         Completed       True      False   \n",
       "\n",
       "   is_test mobile_phone                 name       npn         phone  \\\n",
       "0    False          NaN    Kattia Santamaria       NaN  888-693-0431   \n",
       "1    False          NaN         Meagan O'Dea  18425849  954-600-7392   \n",
       "2    False          NaN        Sui Cer Khamh  19017372  919-916-0937   \n",
       "3    False          NaN  Willis (Lat) Milner   1023744  678-252-1776   \n",
       "4    False          NaN      Nicole Connolly  18245457  800-214-0714   \n",
       "\n",
       "   pivot_id  postal_code agent_state  agency_id                agent  \\\n",
       "0     61522        32746          FL      58649    Kattia Santamaria   \n",
       "1     68781        33328          FL      62967       Meagan Jimenez   \n",
       "2     70765        27525          NC      70765        Sui Cer Khamh   \n",
       "3     63783        30043          GA      60436  Willis (Lat) Milner   \n",
       "4     60767        33431          FL      57387      Nicole Connolly   \n",
       "\n",
       "   agent_id carrier          city             date_created duration_category  \\\n",
       "0     61522    CLIC   Castroville  2021-01-01 00:00:00.000             364x1   \n",
       "1     68781    CLIC     Melbourne  2021-01-05 00:00:00.000             364x1   \n",
       "2     70765    NRIC  Indianapolis  2021-01-07 00:00:00.000             364x1   \n",
       "3     63783    NRIC       Atlanta  2021-01-13 00:00:00.000             180x2   \n",
       "4     60767    CLIC         Plano  2021-01-15 00:00:00.000             180x1   \n",
       "\n",
       "            effective_date               email  estimated_observed_duration  \\\n",
       "0  2021-01-02 00:00:00.000  cimacare@yahoo.com                         7.93   \n",
       "1  2021-01-15 00:00:00.000                 NaN                         7.93   \n",
       "2  2021-01-08 00:00:00.000                 NaN                         7.93   \n",
       "3  2021-01-20 00:00:00.000                 NaN                         7.93   \n",
       "4  2021-01-16 00:00:00.000                 NaN                         4.17   \n",
       "\n",
       "           expiration_date  monthly_premium  monthly_sales_goal payment_type  \\\n",
       "0  2021-12-31 00:00:00.000            47.59               100.0           CC   \n",
       "1  2022-01-13 00:00:00.000           174.70                 NaN          ACH   \n",
       "2  2022-01-06 00:00:00.000            67.56                 NaN           CC   \n",
       "3  2022-01-14 00:00:00.000           228.48                 NaN           CC   \n",
       "4  2021-07-14 00:00:00.000           692.43               500.0          ACH   \n",
       "\n",
       "   percentage_sales          plan_name          plan_tier  policy_id  \\\n",
       "0              45.0  Companion Economy  Companion Economy     338812   \n",
       "1              45.0  Companion Quantum  Companion Quantum     339579   \n",
       "2              45.0     EPIC BASE Plan   North River Base     340130   \n",
       "3              15.0     EPIC BASE Plan   North River Base     341476   \n",
       "4              40.0     Companion Core     Companion Core     341986   \n",
       "\n",
       "   premium_eltv product_classification product_type  revenue_eltv  \\\n",
       "0    114.160082      U65 Major Medical          STM    185.553237   \n",
       "1    419.074727      U65 Major Medical          STM    523.025711   \n",
       "2    139.295208      U65 Major Medical          STM    211.838459   \n",
       "3    543.553920      U65 Major Medical          STM    657.315059   \n",
       "4    873.448513      U65 Major Medical          STM   1007.304102   \n",
       "\n",
       "  sales_channel state         termination_date      zip  zipcode state_zip  \\\n",
       "0     Brokerage    TX  2021-12-31 00:00:00.000  78009.0  32746.0        FL   \n",
       "1     Brokerage    FL  2022-01-13 00:00:00.000  32935.0  33328.0        FL   \n",
       "2     Brokerage    IN  2021-02-07 00:00:00.000  46227.0  27525.0        NC   \n",
       "3     Brokerage    GA  2021-07-18 00:00:00.000  30326.0  30043.0        GA   \n",
       "4     Brokerage    TX  2021-07-14 00:00:00.000  75023.0  33431.0        FL   \n",
       "\n",
       "       lat      lng timezone  radius_in_miles  population  population_density  \\\n",
       "0  28.7577 -81.3508  Eastern              4.0     40571.0              1838.0   \n",
       "1  26.0671 -80.2723  Eastern              2.0     27415.0              2916.0   \n",
       "2  36.0955 -78.4486  Eastern              9.0     13338.0               144.0   \n",
       "3  34.0031 -84.0126  Eastern              6.0     80241.0              2467.0   \n",
       "4  26.3799 -80.0975  Eastern              3.0     18290.0              2057.0   \n",
       "\n",
       "   land_area_in_sqmi  water_area_in_sqmi  housing_units  \\\n",
       "0              22.07                1.50        17700.0   \n",
       "1               9.40                0.08        10431.0   \n",
       "2              92.51                0.29         5797.0   \n",
       "3              32.53                0.39        27767.0   \n",
       "4               8.89                0.77         8375.0   \n",
       "\n",
       "   occupied_housing_units  median_home_value  median_household_income  \\\n",
       "0                 15986.0           245100.0                  75344.0   \n",
       "1                  9956.0           284200.0                  78566.0   \n",
       "2                  5172.0           129100.0                  43090.0   \n",
       "3                 25997.0           171000.0                  67260.0   \n",
       "4                  6896.0           295600.0                  67500.0   \n",
       "\n",
       "   annual_checkup  arthritis  binge_drinking  copd  cancer_except_skin  \\\n",
       "0           77.90       25.3           17.90  6.80                 6.8   \n",
       "1           79.70       23.8           15.80  7.40                 6.9   \n",
       "2           80.15       29.7           14.55  8.75                 7.4   \n",
       "3           76.70       21.1           15.50  5.80                 5.5   \n",
       "4           80.40       28.0           16.30  8.50                 8.7   \n",
       "\n",
       "   cervical_cancer_screening  cholesterol_screening  chronic_kidney_disease  \\\n",
       "0                       85.3                   82.1                    2.80   \n",
       "1                       84.4                   83.3                    3.30   \n",
       "2                       85.4                   80.7                    3.45   \n",
       "3                       83.4                   82.8                    2.70   \n",
       "4                       85.7                   84.2                    3.60   \n",
       "\n",
       "   colorectal_cancer_screening  core_preventive_services_for_older_men  \\\n",
       "0                        67.40                                    31.6   \n",
       "1                        64.60                                    26.7   \n",
       "2                        66.75                                    35.3   \n",
       "3                        62.70                                    30.9   \n",
       "4                        66.60                                    32.8   \n",
       "\n",
       "   core_preventive_services_for_older_women  coronary_heart_disease  \\\n",
       "0                                      31.3                     6.5   \n",
       "1                                      27.4                     7.3   \n",
       "2                                      36.0                     8.1   \n",
       "3                                      35.6                     5.6   \n",
       "4                                      30.6                     8.6   \n",
       "\n",
       "   current_asthma  current_smoking  dental_visit  diabetes  health_insurance  \\\n",
       "0            8.30            15.90         65.60      10.9              19.1   \n",
       "1            8.70            16.50         64.40      13.1              23.9   \n",
       "2           10.05            20.55         62.35      13.8              19.0   \n",
       "3            8.60            14.10         61.30      11.2              23.6   \n",
       "4            8.30            15.20         65.70      13.6              21.9   \n",
       "\n",
       "   high_blood_pressure  high_cholesterol  mammography  mental_health  obesity  \\\n",
       "0                32.10             34.20         75.7          12.80     27.8   \n",
       "1                35.20             34.30         74.3          13.10     29.8   \n",
       "2                39.75             37.05         76.3          14.15     35.2   \n",
       "3                30.00             30.80         78.3          11.90     32.3   \n",
       "4                36.00             36.40         75.6          12.60     29.3   \n",
       "\n",
       "   physical_health  physical_inactivity  sleep_lt_7_hours  stroke  \\\n",
       "0            11.80                24.40              37.9    3.10   \n",
       "1            13.60                26.00              40.6    3.80   \n",
       "2            14.25                27.25              37.2    4.25   \n",
       "3            11.40                26.90              39.4    2.90   \n",
       "4            14.00                28.50              35.6    4.10   \n",
       "\n",
       "   taking_bp_medication  teeth_loss  ma_penetration_2020  ma_penetration_2021  \\\n",
       "0                 73.00       11.70                47.51                49.70   \n",
       "1                 75.00       14.40                59.36                61.51   \n",
       "2                 78.65       18.25                42.63                47.52   \n",
       "3                 75.80       12.60                47.57                51.14   \n",
       "4                 77.20       13.80                42.39                44.41   \n",
       "\n",
       "   delta_ma_enrolled  delta_ma_penetration_points    event_time  \\\n",
       "0             2804.0                         2.19  1.636493e+09   \n",
       "1            11563.0                         2.15  1.636493e+09   \n",
       "2              864.0                         4.89  1.636493e+09   \n",
       "3             5919.0                         3.57  1.636493e+09   \n",
       "4             9991.0                         2.02  1.636493e+09   \n",
       "\n",
       "                write_time      api_invocation_time is_deleted  age_years_tu  \\\n",
       "0  2021-11-09 21:28:53.888  2021-11-09 21:24:11.000      False           NaN   \n",
       "1  2021-11-09 21:28:53.842  2021-11-09 21:26:16.000      False          43.6   \n",
       "2  2021-11-09 21:28:54.121  2021-11-09 21:26:11.000      False          41.4   \n",
       "3  2021-11-09 21:28:54.929  2021-11-09 21:25:48.000      False          52.7   \n",
       "4  2021-11-09 21:28:53.878  2021-11-09 21:26:31.000      False           NaN   \n",
       "\n",
       "   income_dollars_tu  children_yes_tu  education_years_tu  homeowner_yes_tu  \\\n",
       "0                NaN              NaN                 NaN               NaN   \n",
       "1            88000.0              0.0                13.0             100.0   \n",
       "2           133000.0              0.0                14.0             100.0   \n",
       "3           150000.0              0.0                15.0             100.0   \n",
       "4                NaN              NaN                 NaN               NaN   \n",
       "\n",
       "   homevalue_dollars_tu  resident_years_tu  occupation_first_tu  \\\n",
       "0                   NaN                NaN                  NaN   \n",
       "1              285000.0               10.4          whitecollar   \n",
       "2              350000.0                8.9  execuppermanagement   \n",
       "3              333333.0               20.8          whitecollar   \n",
       "4                   NaN                NaN                  NaN   \n",
       "\n",
       "   affiliation_conservative_tu  affiliation_liberal_tu             email_tu  \\\n",
       "0                          NaN                     NaN                  NaN   \n",
       "1                         50.0                    50.0                  NaN   \n",
       "2                        100.0                     0.0   suikhamh@yahoo.com   \n",
       "3                          NaN                     NaN  lat@milnergroup.com   \n",
       "4                          NaN                     NaN                  NaN   \n",
       "\n",
       "       phone_tu first_tu last_tu      city_tu state_tu   zip_tu  \\\n",
       "0           NaN      NaN     NaN          NaN      NaN      NaN   \n",
       "1  9.546007e+09      NaN    odea  cooper city       fl  33328.0   \n",
       "2  9.199161e+09  sui cer   khamh       frisco       tx  75035.0   \n",
       "3  6.782522e+09      NaN  milner  cherry hill       nj   8003.0   \n",
       "4           NaN      NaN     NaN          NaN      NaN      NaN   \n",
       "\n",
       "   ebureau-score-market-201801220508_tu  ebureau-score-market-201805170506_tu  \n",
       "0                                   NaN                                   NaN  \n",
       "1                                 398.0                                 507.0  \n",
       "2                                  49.0                                 573.0  \n",
       "3                                  27.0                                 590.0  \n",
       "4                                   NaN                                   NaN  "
      ]
     },
     "execution_count": 18,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "s3_bucket = 'hc-data-science'\n",
    "object_key = f\"brokerage-agent-recruiting/sales_view-tu.csv\"\n",
    "data_location = 's3://{}/{}'.format(s3_bucket, object_key)\n",
    "\n",
    "df_example = pd.read_csv(data_location)\n",
    "print(df_example.shape)\n",
    "df_example.head()"
   ]
  }
 ],
 "metadata": {
  "instance_type": "ml.r5.xlarge",
  "kernelspec": {
   "display_name": "Python 3 (Data Science)",
   "language": "python",
   "name": "python3__SAGEMAKER_INTERNAL__arn:aws:sagemaker:us-east-1:081325390199:image/datascience-1.0"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.7.10"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 4
}
